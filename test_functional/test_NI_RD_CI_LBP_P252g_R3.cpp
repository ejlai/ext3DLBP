/*  =========================================================================
        Author: Leonardo Citraro
        Company:
        Filename: test_functional.cpp
        Last modifed:   06.04.2017 by Leonardo Citraro
        Description:    Functional test
    
        =========================================================================
    
        =========================================================================
    */
    #include "ext3DLBP.hpp"
    #include <iostream>
    #include <string>
    #include <array>
    #include <cassert>
    
    using namespace ext3DLBP;
    
    template<typename T, size_t N>
    bool check(const std::string& test, const Array1D<T,N>& output, const Array1D<T,N>& truth) {
        if( output==truth ) {
            std::cout << test << " passed!\n";
            return true;
        } else {
            std::cout << test << " failed!\n";
            std::cout << "output: [";
            for(const auto& e:output)
                std::cout << e << ",";
            std::cout << "]\n";
            std::cout << "truth:  [";
            for(const auto& e:truth)
                std::cout << e << ",";
            std::cout << "]\n";
            return false;
        }
    }
    template<typename T>
    bool check(const std::string& test, const T output, const T truth) {
        if( output==truth ) {
            std::cout << test << " passed!\n";
            return true;
        } else {
            std::cout << test << " failed!\n";
            std::cout << "output: " << output << "\n";
            std::cout << "truth:  " << truth << "\n";
            return false;
        }
    }  
    
    int main(int argc, char* argv[]){
     
    
std::cout << "=============================================\n";
std::string test = "NI_RD_CI_LBP_P252g_R3";
{
	Array3D<int,7,7,7> array = {{
		{{{4,62,9,218,14,207,231},{28,28,32,70,169,207,55},{145,53,26,190,196,162,145},{144,167,142,67,223,153,105},{161,11,163,198,189,22,95},{123,107,248,61,205,169,155},{238,70,58,113,0,28,5}}},
		{{{8,78,202,78,144,84,71},{218,103,217,64,82,53,109},{204,244,202,110,170,249,52},{56,229,230,104,13,157,62},{86,131,230,201,170,102,2},{183,188,212,24,31,66,157},{178,49,29,103,95,82,13}}},
		{{{151,206,75,100,163,133,93},{147,113,7,20,169,90,42},{122,82,120,76,30,77,44},{204,156,61,214,190,83,13},{195,143,205,241,16,164,242},{81,236,236,16,124,11,101},{45,237,6,141,52,209,60}}},
		{{{143,167,193,140,151,111,34},{168,153,42,8,133,127,25},{125,114,221,234,4,123,120},{71,162,132,73,117,176,173},{118,45,104,57,178,25,226},{211,141,44,215,217,52,44},{76,216,203,99,6,58,79}}},
		{{{70,94,198,40,207,192,118},{170,234,123,206,76,118,58},{55,118,243,201,41,54,70},{191,171,124,216,246,8,236},{169,246,98,159,175,150,82},{8,98,151,114,184,170,20},{208,60,195,188,175,163,15}}},
		{{{3,75,89,31,224,123,116},{134,58,43,219,197,140,252},{12,71,237,49,18,165,177},{151,94,141,198,27,62,13},{217,157,149,242,166,32,107},{210,34,125,247,244,39,193},{70,252,25,236,69,26,37}}},
		{{{13,127,24,250,2,26,203},{247,241,97,184,222,18,108},{213,92,172,186,8,215,214},{206,219,217,94,93,251,95},{34,32,175,245,168,239,145},{46,220,116,124,8,138,197},{183,20,52,19,49,137,31}}}
	}};
	double mur = 170;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {129,253,0};
	assert( check(test+" Test 0", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{56,177,131,250,236,153,69},{158,23,23,57,187,249,52},{23,71,133,254,181,86,110},{202,117,108,40,190,148,162},{20,164,202,93,200,45,52},{190,235,193,206,168,100,83},{122,186,233,66,143,189,90}}},
		{{{198,200,36,121,196,32,37},{26,239,58,113,245,75,59},{4,44,247,194,247,189,176},{73,68,240,184,213,128,247},{61,81,72,21,87,74,220},{80,22,246,49,209,196,32},{166,133,212,191,218,137,204}}},
		{{{154,131,203,207,174,142,16},{114,246,149,98,147,104,151},{132,75,252,238,129,222,102},{138,154,43,43,201,62,65},{146,190,14,2,24,174,63},{118,40,62,171,191,142,213},{170,137,183,204,130,117,251}}},
		{{{172,199,188,46,179,28,117},{160,238,104,16,111,18,201},{204,231,50,7,6,146,104},{4,163,128,127,222,127,13},{182,229,138,169,198,192,13},{59,143,46,165,144,190,186},{102,167,12,127,216,19,102}}},
		{{{33,52,144,140,211,33,132},{154,109,34,205,157,232,190},{69,193,131,116,196,2,251},{155,116,212,141,228,131,112},{232,237,57,145,250,223,65},{45,47,116,241,102,237,59},{212,11,241,124,237,77,21}}},
		{{{68,89,121,131,27,48,141},{17,202,96,91,76,123,63},{197,253,219,169,153,228,248},{137,127,62,30,233,54,204},{146,247,197,237,3,193,142},{173,237,13,246,250,118,116},{210,227,91,15,89,210,223}}},
		{{{139,43,40,223,203,209,111},{164,39,184,191,52,32,116},{87,33,1,27,59,215,162},{75,142,156,196,107,182,194},{5,4,103,202,130,178,245},{150,33,35,141,126,167,143},{46,244,41,15,230,90,167}}}
	}};
	double mur = 38;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 1", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{111,95,151,39,73,55,253},{21,31,99,24,0,237,221},{155,6,74,124,1,160,48},{158,138,225,75,231,60,148},{135,95,20,18,203,185,23},{230,227,9,115,213,139,236},{250,232,210,88,0,224,51}}},
		{{{189,161,219,28,66,178,34},{144,119,245,93,93,99,225},{92,133,110,180,63,16,158},{52,48,41,52,213,98,54},{71,164,147,225,221,99,27},{156,241,13,141,243,0,114},{155,202,178,96,90,76,67}}},
		{{{105,174,29,223,152,100,190},{218,101,2,245,15,47,225},{211,96,67,87,43,52,158},{34,1,97,189,204,165,18},{33,162,220,120,31,228,238},{98,94,74,61,126,118,181},{42,134,167,210,93,147,57}}},
		{{{223,123,151,214,43,10,143},{14,116,25,241,211,241,85},{175,249,55,53,197,41,238},{121,26,109,14,216,236,25},{95,131,62,155,85,100,240},{247,11,222,138,71,183,210},{166,61,30,20,208,104,240}}},
		{{{234,109,250,59,88,202,205},{52,62,107,225,33,160,87},{42,123,67,151,107,47,2},{17,32,188,17,70,29,30},{216,33,150,55,184,56,234},{220,72,177,194,250,90,59},{77,6,61,198,103,231,244}}},
		{{{234,60,253,9,115,124,203},{229,118,133,8,209,31,203},{51,81,111,8,126,119,147},{204,140,205,168,231,176,170},{7,94,149,72,230,23,216},{43,208,141,89,122,203,149},{171,27,6,216,150,29,32}}},
		{{{28,197,158,231,137,193,245},{167,86,138,234,2,15,128},{149,71,106,194,200,209,235},{81,45,43,2,69,114,17},{249,120,143,23,105,11,170},{14,33,115,239,230,233,38},{64,12,2,78,103,49,212}}}
	}};
	double mur = 102;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 2", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{40,83,180,0,144,129,98},{98,83,243,145,153,92,135},{27,74,156,232,181,165,99},{30,127,106,179,108,14,231},{14,90,91,140,72,224,150},{174,247,209,142,161,180,64},{16,230,231,225,166,220,245}}},
		{{{97,66,154,76,13,126,230},{231,240,76,142,217,236,207},{239,138,246,153,31,252,175},{200,128,157,213,131,75,66},{147,156,81,162,76,72,100},{154,31,205,182,93,157,217},{153,231,203,119,125,236,231}}},
		{{{36,110,161,94,74,62,40},{101,1,150,13,240,98,140},{69,230,185,49,23,27,25},{58,22,51,153,161,133,104},{102,167,42,234,146,39,152},{81,21,108,201,90,236,2},{3,160,76,219,0,209,77}}},
		{{{237,174,197,174,98,197,179},{108,41,44,114,223,221,219},{7,35,168,22,72,75,113},{36,143,219,33,83,76,132},{79,199,109,65,115,16,184},{230,51,222,170,61,110,38},{237,238,195,92,114,106,247}}},
		{{{106,170,92,105,26,224,115},{173,106,23,223,137,3,191},{196,118,194,95,89,66,8},{2,244,223,14,112,168,40},{50,129,244,252,154,57,39},{59,188,28,155,193,59,171},{203,249,207,130,62,203,191}}},
		{{{90,198,177,68,172,221,243},{180,6,53,169,1,19,79},{3,54,197,189,162,247,172},{197,0,250,140,222,32,79},{168,50,79,81,231,123,53},{111,147,222,138,175,199,84},{5,211,157,82,98,38,85}}},
		{{{220,3,170,158,48,162,189},{49,232,244,27,14,137,223},{30,126,15,178,7,123,113},{91,93,110,73,200,145,36},{36,155,27,235,139,23,59},{220,121,245,101,214,112,57},{60,157,206,114,109,189,177}}}
	}};
	double mur = 60;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 3", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{22,136,14,85,128,94,25},{107,17,149,237,145,241,154},{31,227,61,239,12,202,27},{92,172,137,250,108,51,7},{83,49,89,69,238,77,222},{52,148,53,241,218,235,250},{58,3,99,36,169,249,226}}},
		{{{23,147,157,143,189,21,86},{169,15,158,162,191,134,5},{42,248,62,240,90,90,114},{169,250,179,18,207,10,97},{34,18,116,62,250,190,47},{92,1,172,96,37,240,158},{235,75,43,67,204,208,27}}},
		{{{213,168,123,216,200,77,10},{123,48,128,195,58,104,27},{156,152,190,60,75,82,188},{140,39,194,95,177,32,93},{142,91,123,170,106,42,158},{27,163,37,116,93,23,183},{142,56,191,65,253,247,204}}},
		{{{37,220,129,39,174,141,65},{174,233,93,233,83,119,194},{222,242,182,93,201,145,202},{147,195,167,80,110,52,251},{167,149,132,73,73,167,220},{215,194,192,67,98,247,54},{208,111,230,69,0,89,26}}},
		{{{56,33,227,117,231,38,247},{65,232,254,154,138,253,13},{224,110,52,133,200,93,200},{115,166,10,206,4,146,147},{24,145,75,214,212,156,60},{82,51,174,135,212,152,190},{37,159,41,216,209,228,162}}},
		{{{140,37,140,247,86,206,161},{180,113,54,239,144,132,177},{175,183,160,239,240,56,82},{237,232,122,104,129,7,132},{77,191,101,123,186,154,73},{47,145,91,232,122,243,218},{179,22,165,83,62,172,214}}},
		{{{126,207,199,97,251,67,35},{9,78,209,144,130,114,239},{243,142,9,100,77,176,123},{29,214,96,90,121,1,138},{55,125,215,4,254,180,181},{110,196,254,227,113,167,113},{120,181,37,160,155,102,252}}}
	}};
	double mur = 166;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {135,253,0};
	assert( check(test+" Test 4", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{62,39,11,195,158,61,169},{125,213,48,88,58,10,115},{164,195,210,93,246,176,207},{129,13,8,148,67,234,75},{123,45,30,105,42,221,95},{31,16,206,79,15,29,14},{175,195,243,25,190,92,7}}},
		{{{154,120,136,56,235,172,146},{242,72,6,30,35,78,22},{136,181,224,11,119,158,169},{156,64,215,2,15,220,69},{33,221,211,94,39,53,252},{48,101,171,177,172,234,48},{221,151,12,62,243,131,87}}},
		{{{253,233,46,83,209,73,101},{241,137,133,160,89,203,40},{121,196,80,26,122,90,204},{110,8,163,109,183,132,30},{163,44,35,218,171,151,76},{22,158,199,192,102,101,48},{61,216,37,172,27,11,221}}},
		{{{102,100,104,240,236,81,174},{65,140,119,146,226,168,121},{143,149,139,119,83,42,175},{245,56,221,215,78,103,93},{119,89,241,29,224,190,172},{116,138,43,241,43,224,218},{104,183,216,23,140,167,192}}},
		{{{222,32,31,30,9,168,236},{245,146,24,133,244,61,208},{24,234,29,91,60,239,252},{79,102,220,147,205,194,152},{198,219,10,75,179,189,188},{253,15,59,187,15,219,92},{156,20,223,146,58,222,152}}},
		{{{128,137,46,145,147,25,90},{107,154,82,235,112,99,15},{230,219,63,203,206,154,239},{216,160,191,103,188,71,13},{97,122,23,227,132,242,21},{243,163,122,20,41,138,86},{246,243,145,123,221,237,14}}},
		{{{151,172,171,117,76,12,64},{248,173,131,248,186,99,203},{90,212,33,149,56,150,186},{244,5,109,9,24,182,212},{240,85,122,10,206,206,197},{18,236,232,55,188,189,49},{117,109,176,9,210,149,189}}}
	}};
	double mur = 158;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 5", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{220,15,87,192,137,222,51},{197,62,96,138,6,91,163},{104,196,220,57,60,157,23},{62,79,45,106,58,17,243},{210,183,56,210,23,77,118},{55,156,45,56,78,181,240},{56,133,179,208,243,26,76}}},
		{{{7,124,187,250,77,133,189},{12,148,45,192,71,97,62},{116,163,167,9,222,246,181},{227,167,98,204,111,163,130},{133,63,20,219,212,154,127},{62,183,150,247,169,209,106},{124,2,172,25,29,64,70}}},
		{{{164,231,189,191,62,252,164},{1,208,157,92,35,9,204},{113,63,114,87,246,124,34},{127,72,114,181,192,27,13},{140,18,121,152,79,224,216},{254,89,39,8,179,60,174},{40,129,61,12,115,37,187}}},
		{{{249,56,40,5,167,49,242},{151,143,2,190,163,218,226},{222,74,212,91,74,14,188},{68,226,91,164,152,150,176},{91,65,3,226,224,189,24},{50,172,134,14,4,246,190},{149,206,17,236,79,87,64}}},
		{{{160,49,161,248,179,199,192},{213,10,121,182,232,241,22},{36,111,171,89,112,195,85},{218,87,58,200,45,80,112},{166,166,27,161,86,247,88},{70,56,239,17,114,226,146},{40,119,129,48,109,11,146}}},
		{{{167,182,160,129,233,70,118},{148,25,128,236,251,215,25},{3,238,203,83,219,48,70},{122,197,52,32,192,210,254},{11,57,240,228,111,54,133},{138,153,2,42,86,32,0},{159,127,13,150,176,250,182}}},
		{{{158,67,212,29,72,21,49},{233,212,180,36,55,173,168},{106,15,77,124,8,211,175},{150,109,79,81,186,235,233},{6,254,31,122,115,57,14},{84,140,106,133,93,84,72},{60,203,28,34,245,6,118}}}
	}};
	double mur = 60;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 6", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{232,194,197,157,206,131,245},{252,8,70,232,241,226,7},{211,116,144,131,88,245,240},{130,89,225,115,197,76,18},{97,235,253,142,3,89,57},{218,189,71,188,87,80,232},{86,127,185,142,208,201,216}}},
		{{{227,126,62,92,170,144,220},{10,5,35,69,99,14,22},{123,194,22,59,47,252,56},{189,146,74,52,103,42,228},{173,231,13,88,238,112,52},{115,182,92,185,158,208,112},{146,253,190,45,128,95,70}}},
		{{{120,180,252,70,46,127,197},{179,11,186,201,58,26,101},{197,94,20,146,43,38,57},{106,241,198,117,180,22,90},{98,67,15,137,30,32,170},{177,206,43,183,89,127,109},{251,97,84,14,109,133,145}}},
		{{{96,127,232,219,231,238,246},{236,244,181,67,154,22,192},{204,160,57,93,94,139,0},{220,156,79,3,90,183,66},{226,33,180,40,245,120,155},{90,12,71,139,88,202,108},{68,76,105,84,51,146,236}}},
		{{{50,162,109,62,26,38,149},{103,6,174,235,99,52,55},{145,114,81,106,79,32,137},{92,138,79,196,118,185,213},{104,37,78,232,50,185,221},{43,149,38,145,198,239,52},{247,151,3,77,28,110,44}}},
		{{{10,16,198,124,85,20,142},{3,148,163,134,186,26,38},{19,57,114,158,169,194,198},{79,152,134,24,90,182,143},{35,32,100,111,193,89,115},{156,106,90,251,61,140,127},{144,96,105,127,173,85,186}}},
		{{{189,249,119,165,19,75,182},{183,18,207,143,89,68,18},{143,160,86,36,178,206,240},{163,213,234,77,18,245,143},{231,225,118,112,85,4,156},{115,241,186,69,216,64,4},{78,195,202,241,164,213,55}}}
	}};
	double mur = 165;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 7", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{250,2,53,191,226,184,232},{96,245,237,11,181,123,52},{235,3,220,124,18,252,14},{128,74,65,35,147,40,55},{165,22,144,17,84,199,179},{28,54,60,146,238,88,108},{181,31,246,232,14,104,190}}},
		{{{9,200,25,128,153,37,114},{197,157,153,24,23,189,135},{116,62,116,4,52,92,77},{219,27,232,56,31,8,102},{80,240,53,242,40,220,126},{29,83,169,155,131,18,42},{60,106,123,157,4,138,156}}},
		{{{215,1,158,201,166,202,4},{169,138,226,250,142,31,19},{251,221,172,162,213,15,33},{117,192,202,115,105,89,137},{113,41,32,176,70,215,202},{143,144,201,98,18,57,56},{54,45,27,250,187,143,174}}},
		{{{208,223,225,226,241,130,4},{39,185,208,110,196,140,0},{123,58,207,0,196,102,188},{134,12,250,44,35,155,207},{100,49,50,134,216,22,144},{62,46,12,16,250,232,228},{178,102,153,130,206,84,83}}},
		{{{163,103,91,202,179,209,38},{105,137,28,124,12,78,173},{178,73,23,8,230,233,75},{246,240,104,218,42,127,128},{41,231,183,64,131,142,109},{18,39,118,14,5,201,138},{45,72,185,149,229,71,14}}},
		{{{221,15,77,187,136,113,175},{240,205,243,154,80,236,72},{179,210,72,98,143,61,41},{224,36,187,205,66,3,0},{136,104,237,87,230,186,230},{168,126,161,147,54,209,160},{215,23,241,132,170,168,220}}},
		{{{86,173,26,53,57,120,202},{56,81,50,162,84,184,220},{71,0,123,1,28,214,92},{54,119,220,133,209,87,188},{65,8,2,97,89,77,24},{161,122,18,51,111,197,145},{190,23,16,29,24,105,173}}}
	}};
	double mur = 200;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {130,137,0};
	assert( check(test+" Test 8", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{127,175,216,237,100,231,73},{145,54,131,188,37,206,56},{223,249,178,165,127,15,168},{203,239,173,208,103,48,239},{166,117,55,173,224,75,144},{151,10,55,42,96,163,12},{47,39,211,12,48,89,229}}},
		{{{250,209,113,148,217,158,22},{168,27,35,244,127,192,166},{128,150,20,244,187,89,81},{79,135,247,134,113,217,70},{41,95,137,97,49,117,207},{242,253,219,214,25,67,42},{238,185,214,45,26,253,212}}},
		{{{169,125,104,210,232,95,236},{20,249,242,250,19,193,253},{33,81,112,129,37,66,239},{161,130,228,153,112,93,69},{214,182,129,113,139,221,82},{30,52,60,16,204,178,208},{219,119,141,141,170,234,47}}},
		{{{41,162,124,131,149,98,171},{128,113,186,132,201,140,29},{127,31,52,32,237,79,19},{100,42,142,251,58,99,155},{235,235,43,47,106,55,63},{190,29,63,223,152,174,191},{193,57,94,244,249,130,17}}},
		{{{30,57,243,34,11,60,50},{3,208,229,252,120,214,39},{69,55,224,60,65,109,176},{238,122,129,119,14,46,10},{124,15,216,96,24,184,5},{85,12,193,31,81,182,66},{200,113,196,43,0,23,154}}},
		{{{25,90,64,92,142,78,26},{44,30,253,73,112,151,51},{125,235,242,199,91,246,188},{31,22,60,47,168,46,159},{171,124,92,11,0,52,58},{43,50,2,133,164,62,248},{28,128,15,249,10,105,54}}},
		{{{193,25,212,235,47,154,152},{43,97,154,138,220,251,205},{209,207,123,228,61,114,170},{210,112,8,52,22,108,250},{59,82,83,230,228,43,189},{109,27,150,212,21,167,221},{168,170,229,188,204,151,99}}}
	}};
	double mur = 240;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 9", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{214,140,53,9,90,253,205},{36,180,98,45,189,131,24},{62,30,19,3,178,72,138},{122,45,145,188,134,27,2},{69,68,29,171,99,117,233},{92,119,92,10,83,164,45},{155,116,21,199,67,79,91}}},
		{{{221,185,153,54,0,65,213},{172,41,123,175,23,7,40},{221,114,186,177,111,189,238},{124,47,161,215,106,203,128},{35,197,129,55,32,214,101},{27,226,205,243,3,238,109},{75,145,73,45,246,136,144}}},
		{{{175,30,200,241,145,95,213},{66,22,236,230,124,133,115},{103,115,88,175,51,203,247},{160,31,229,160,55,168,220},{69,186,229,198,50,165,86},{168,128,244,111,98,61,155},{210,72,224,218,153,19,20}}},
		{{{76,229,22,49,117,152,220},{25,200,20,251,239,50,81},{210,206,48,24,224,72,96},{218,198,100,121,244,214,92},{244,184,86,167,87,135,118},{72,238,254,13,202,33,49},{157,94,75,195,22,150,158}}},
		{{{46,4,20,248,69,93,200},{61,29,156,204,158,158,252},{186,151,68,201,93,136,43},{145,46,65,74,235,206,254},{103,125,115,198,231,99,48},{224,65,143,121,161,1,65},{16,157,129,1,22,188,97}}},
		{{{223,65,221,188,251,24,178},{12,123,127,193,252,100,39},{139,245,103,58,28,79,8},{37,114,188,251,208,164,175},{214,187,240,116,169,12,26},{96,19,43,173,57,251,207},{220,245,65,210,216,163,11}}},
		{{{7,112,227,152,185,168,72},{252,161,233,135,92,219,48},{24,171,78,220,125,251,197},{179,136,226,135,214,243,140},{219,118,23,79,181,85,141},{0,70,226,92,248,14,84},{130,33,230,144,119,124,119}}}
	}};
	double mur = 228;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 10", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{185,57,119,210,141,141,110},{117,48,52,95,116,246,191},{127,42,30,41,73,84,250},{146,167,91,201,166,166,234},{124,240,73,170,121,21,128},{13,191,40,150,231,163,77},{214,201,228,62,114,82,19}}},
		{{{127,40,241,128,49,26,69},{2,121,23,112,95,24,251},{204,105,49,157,164,79,83},{246,8,226,137,25,17,199},{124,87,130,20,55,104,232},{128,91,118,218,167,238,88},{149,14,194,152,185,216,206}}},
		{{{210,156,232,106,246,176,180},{10,75,246,88,143,62,125},{0,82,30,97,44,191,12},{168,132,2,253,220,143,163},{150,251,142,211,35,247,116},{200,1,211,81,64,15,129},{94,68,253,163,51,123,228}}},
		{{{232,155,70,85,119,108,36},{2,60,180,31,21,192,67},{17,156,111,42,220,85,20},{20,126,140,135,59,225,100},{7,126,147,177,163,108,89},{66,41,136,17,98,191,163},{228,35,21,222,138,160,86}}},
		{{{137,109,201,49,186,23,251},{115,223,248,133,141,248,98},{7,119,242,24,94,99,162},{153,84,122,47,55,173,219},{20,9,151,17,8,214,232},{19,87,92,252,212,81,205},{133,206,176,242,186,111,81}}},
		{{{205,92,209,14,58,75,101},{5,122,196,219,197,96,221},{140,24,219,174,87,158,86},{39,0,145,99,14,90,146},{105,12,165,38,29,193,174},{190,242,37,3,195,78,214},{247,197,147,37,64,147,165}}},
		{{{18,220,81,119,32,160,101},{45,23,98,172,42,178,122},{92,143,208,181,220,175,43},{99,66,53,40,23,26,223},{191,12,38,30,221,157,10},{22,233,25,60,89,18,147},{112,79,146,89,113,69,134}}}
	}};
	double mur = 93;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 11", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{234,30,5,24,126,44,33},{155,133,15,140,166,21,187},{68,127,76,215,172,72,161},{191,157,225,146,168,165,39},{244,205,96,71,202,74,41},{234,22,119,77,110,113,159},{248,100,74,20,26,13,193}}},
		{{{160,73,86,5,171,29,179},{201,149,180,248,205,15,36},{115,107,47,211,237,93,30},{5,113,72,83,253,41,149},{37,24,122,124,63,95,126},{49,168,145,62,52,138,216},{240,121,171,196,240,61,68}}},
		{{{219,119,169,222,51,72,20},{206,32,175,130,15,43,162},{225,14,196,212,107,39,122},{179,102,145,99,132,133,234},{235,2,24,60,201,254,28},{95,190,169,33,72,173,134},{127,78,197,161,221,165,32}}},
		{{{165,38,32,126,220,181,103},{189,66,175,32,42,193,241},{145,33,132,208,8,236,80},{154,244,123,186,70,64,194},{218,67,115,20,223,193,26},{137,75,112,81,12,230,113},{187,27,233,120,233,113,63}}},
		{{{20,65,9,57,112,101,251},{251,32,238,163,108,237,131},{212,214,140,64,59,232,34},{234,16,14,137,122,239,169},{246,191,10,114,29,27,163},{140,147,3,178,96,103,225},{213,71,35,94,235,85,245}}},
		{{{65,44,197,251,32,64,27},{74,139,230,9,17,105,109},{135,3,30,193,172,147,43},{65,99,248,137,32,220,226},{98,143,186,190,166,116,51},{245,197,83,56,170,14,192},{6,172,195,230,82,121,220}}},
		{{{82,38,70,100,160,247,108},{155,118,179,152,7,11,68},{50,102,171,228,176,35,28},{136,254,90,165,207,37,231},{249,63,8,169,79,146,185},{94,204,85,105,108,74,122},{39,88,3,243,33,103,122}}}
	}};
	double mur = 136;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {131,253,1};
	assert( check(test+" Test 12", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{129,26,199,152,196,0,185},{16,103,45,93,236,228,23},{71,241,162,68,107,180,28},{237,163,135,223,8,99,173},{5,80,151,31,247,38,187},{212,100,236,56,117,22,17},{161,75,54,0,192,200,47}}},
		{{{157,240,32,58,47,238,157},{148,156,193,115,100,162,107},{21,205,114,206,0,251,127},{106,7,34,193,234,163,216},{173,216,60,90,181,68,79},{152,120,74,54,6,170,14},{118,162,93,74,36,162,112}}},
		{{{197,16,27,26,114,73,10},{254,14,113,244,179,203,239},{23,199,10,168,74,120,172},{145,28,62,11,118,18,246},{29,158,124,89,168,37,90},{214,222,84,136,140,248,246},{94,79,96,91,21,148,26}}},
		{{{228,228,184,109,225,34,46},{152,107,104,100,163,230,131},{220,48,4,98,122,89,9},{65,67,253,254,1,34,26},{18,113,138,96,246,235,249},{11,241,248,94,239,174,163},{15,28,140,117,206,150,121}}},
		{{{150,193,197,36,3,23,43},{57,71,190,58,153,95,104},{50,64,222,80,12,141,111},{181,197,57,116,126,104,224},{51,24,136,228,215,250,79},{40,207,244,27,228,212,221},{28,133,47,117,46,47,97}}},
		{{{90,134,43,61,195,196,119},{153,93,132,50,199,138,56},{102,169,120,12,221,46,111},{61,15,101,15,115,187,160},{77,233,59,167,166,25,74},{112,210,162,3,252,52,243},{87,137,137,131,161,175,160}}},
		{{{239,213,221,96,130,173,7},{43,24,89,195,52,148,42},{119,186,29,149,82,109,236},{38,89,151,36,115,216,110},{223,190,29,230,167,214,2},{130,39,32,40,62,47,38},{50,83,157,82,6,120,243}}}
	}};
	double mur = 229;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 13", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{102,242,238,22,1,24,250},{29,202,2,26,231,179,30},{110,124,0,227,85,144,94},{121,159,101,53,88,219,9},{141,182,99,206,87,54,247},{46,42,15,5,101,180,129},{82,221,2,142,200,1,98}}},
		{{{70,197,198,40,76,94,125},{31,63,55,163,159,100,108},{243,130,218,249,114,225,40},{77,254,130,166,97,77,245},{28,247,123,218,14,158,205},{250,44,122,28,122,93,70},{133,5,136,205,148,11,241}}},
		{{{218,175,10,151,240,161,9},{114,97,37,50,215,131,7},{178,147,84,7,165,27,104},{166,188,117,174,189,35,41},{170,89,148,233,21,25,218},{140,109,231,155,24,117,167},{67,32,192,90,77,207,35}}},
		{{{175,6,78,130,46,131,12},{165,52,197,169,223,226,57},{215,139,248,30,180,108,184},{90,199,49,197,144,28,17},{43,42,167,222,72,165,136},{239,252,159,142,46,174,38},{157,50,67,223,57,128,144}}},
		{{{224,213,207,160,64,23,102},{37,181,6,253,50,181,177},{92,126,211,138,68,227,28},{117,41,127,136,228,199,186},{84,57,215,125,185,28,13},{202,129,39,141,196,240,187},{47,126,179,84,22,79,109}}},
		{{{223,201,75,146,61,193,248},{31,231,83,189,15,16,10},{200,13,1,139,88,107,3},{153,44,16,27,91,103,20},{129,77,26,222,240,83,57},{121,221,235,198,199,51,127},{109,10,209,157,70,76,218}}},
		{{{168,41,86,67,254,187,230},{139,111,138,148,120,61,3},{92,221,148,54,237,26,89},{32,224,207,85,113,97,220},{7,88,194,9,117,168,120},{195,142,92,112,50,101,240},{82,112,105,253,76,208,227}}}
	}};
	double mur = 153;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 14", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{56,102,103,202,252,17,176},{116,249,201,15,63,137,36},{187,114,138,69,161,8,56},{34,246,26,28,176,33,64},{73,220,167,123,135,206,157},{57,54,28,97,120,24,48},{181,122,213,221,26,234,205}}},
		{{{170,52,93,19,135,131,202},{145,224,82,112,43,217,2},{37,128,217,57,124,178,51},{47,2,129,83,165,201,168},{60,147,217,84,102,215,94},{69,69,135,205,232,135,165},{98,203,52,61,98,118,72}}},
		{{{121,33,87,234,208,64,40},{240,96,14,20,240,232,150},{107,175,202,118,80,165,19},{115,235,235,9,5,96,217},{159,149,201,228,133,62,24},{56,9,2,81,193,0,104},{10,143,21,110,223,58,145}}},
		{{{190,63,163,45,191,135,211},{48,181,62,89,116,84,190},{238,23,153,32,209,232,246},{71,175,154,182,74,157,176},{58,114,144,193,99,131,124},{187,149,98,11,9,158,58},{46,225,65,126,244,197,15}}},
		{{{103,213,191,75,198,11,191},{249,22,94,243,48,67,174},{150,15,174,9,156,116,111},{162,187,132,14,45,200,178},{55,145,209,157,46,36,236},{52,58,238,201,30,201,111},{17,47,226,72,211,118,111}}},
		{{{31,179,81,24,243,38,156},{249,29,4,61,18,50,249},{61,226,238,146,195,25,173},{152,173,162,55,199,253,252},{100,15,130,155,71,40,37},{192,246,161,45,52,81,170},{16,74,211,60,184,112,113}}},
		{{{151,63,253,138,152,136,253},{40,229,18,105,49,174,230},{0,218,1,200,162,140,221},{39,186,254,126,88,56,157},{146,152,237,149,119,109,204},{39,84,22,163,154,0,98},{42,38,91,33,200,199,51}}}
	}};
	double mur = 234;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 15", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{193,126,53,211,141,30,110},{207,14,153,30,199,177,130},{90,147,142,5,112,15,82},{248,216,226,55,69,124,84},{40,86,207,104,187,73,227},{81,102,222,138,3,221,77},{15,236,235,13,65,199,244}}},
		{{{213,226,111,82,28,219,12},{217,51,195,200,244,123,241},{210,58,114,122,20,160,48},{162,151,20,63,200,128,218},{123,126,229,106,221,233,237},{90,171,144,108,216,204,5},{121,206,18,33,161,186,149}}},
		{{{11,171,250,230,42,181,37},{226,160,131,20,10,226,21},{231,200,237,234,189,73,59},{133,251,176,194,53,48,54},{122,114,191,169,252,95,126},{62,76,5,26,81,25,166},{249,150,230,87,109,93,136}}},
		{{{202,102,11,12,150,28,147},{54,229,117,214,73,232,213},{85,2,0,131,133,179,57},{56,204,106,124,149,24,144},{61,46,159,206,160,102,192},{248,128,204,34,242,34,43},{54,124,69,189,206,87,181}}},
		{{{237,87,236,163,79,82,104},{99,84,95,9,104,148,208},{70,12,69,48,41,205,232},{150,231,146,36,230,55,175},{149,78,132,5,154,208,142},{26,4,180,109,197,178,154},{25,81,103,54,27,147,137}}},
		{{{138,67,7,127,232,188,111},{195,132,40,42,226,44,51},{80,3,147,31,121,140,194},{48,61,163,217,226,161,177},{63,146,231,22,157,209,213},{167,142,75,156,101,111,177},{239,130,253,54,18,251,130}}},
		{{{57,153,219,23,205,252,206},{127,172,58,58,160,29,33},{244,223,127,111,223,44,36},{119,191,12,8,48,81,11},{22,205,156,128,56,230,236},{15,147,39,58,133,167,86},{121,182,109,189,121,239,25}}}
	}};
	double mur = 202;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 16", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{239,211,15,212,98,253,36},{221,52,25,165,152,151,131},{15,34,216,130,160,160,137},{192,57,5,163,152,205,66},{127,48,172,86,149,95,85},{233,200,208,89,221,229,149},{198,13,55,14,181,6,179}}},
		{{{189,80,39,64,160,26,211},{60,202,107,5,199,236,143},{165,238,85,93,105,50,195},{65,167,34,164,42,178,98},{205,190,161,151,204,31,84},{11,119,242,100,53,36,232},{90,132,238,161,46,134,187}}},
		{{{172,177,68,149,70,195,119},{21,125,95,113,96,85,35},{119,237,253,47,41,54,161},{251,31,159,216,226,21,173},{121,140,125,194,176,78,112},{164,220,190,105,180,222,21},{184,244,176,99,77,9,26}}},
		{{{197,187,254,170,188,200,227},{23,233,41,122,229,253,251},{151,47,22,58,32,142,186},{64,119,12,12,76,235,221},{81,65,134,7,116,24,145},{97,202,156,49,28,23,40},{192,191,92,51,115,172,19}}},
		{{{228,180,38,0,102,251,222},{6,30,31,31,110,142,27},{13,83,78,60,20,140,40},{13,204,99,254,180,54,75},{136,157,27,166,167,140,21},{39,249,248,6,195,138,82},{164,232,115,227,144,236,47}}},
		{{{230,5,30,203,1,116,144},{66,121,74,132,220,149,166},{190,33,223,198,5,97,103},{204,152,72,65,70,151,116},{83,84,53,151,40,242,96},{30,57,11,106,252,99,133},{2,30,247,60,47,213,122}}},
		{{{148,121,48,44,184,52,179},{150,166,202,140,19,107,105},{158,83,110,28,10,223,222},{225,64,14,27,33,208,249},{180,86,17,120,14,152,226},{177,143,51,0,54,127,41},{22,169,47,140,69,229,47}}}
	}};
	double mur = 114;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 17", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{75,135,6,72,240,88,62},{178,11,186,110,102,37,169},{67,24,37,61,133,166,245},{119,193,248,136,183,163,202},{48,185,210,11,203,182,93},{18,22,120,95,143,158,194},{44,164,196,25,77,119,225}}},
		{{{148,141,253,117,37,236,74},{22,246,131,18,120,179,107},{186,164,141,253,59,5,128},{148,36,237,129,252,171,122},{219,247,125,222,51,132,212},{3,162,15,108,60,96,46},{112,177,229,98,177,202,202}}},
		{{{40,52,45,204,113,229,79},{130,207,32,29,179,8,77},{20,116,225,151,131,70,156},{3,234,31,176,233,68,147},{105,50,249,17,113,78,23},{94,228,212,155,210,228,55},{72,60,84,153,43,160,129}}},
		{{{172,11,33,104,110,189,194},{66,165,110,76,83,150,149},{213,91,204,31,120,236,225},{33,9,123,232,3,176,133},{65,73,245,222,141,154,196},{101,231,141,189,11,251,117},{218,207,124,30,198,27,25}}},
		{{{111,187,61,104,241,68,47},{188,169,130,116,178,119,85},{205,199,211,139,77,222,42},{98,102,247,193,186,161,194},{26,122,239,153,29,38,91},{138,105,31,173,24,46,122},{38,66,178,11,204,60,5}}},
		{{{46,131,4,164,122,168,25},{214,194,166,186,178,57,19},{0,58,117,89,87,81,176},{226,52,172,152,231,121,37},{91,140,202,89,169,75,155},{131,184,235,203,184,109,23},{221,12,115,201,128,26,253}}},
		{{{179,195,15,254,31,207,48},{63,200,238,169,31,117,10},{31,38,111,254,55,92,114},{114,229,172,135,63,219,154},{19,181,156,119,73,28,34},{182,138,120,24,124,178,199},{94,42,54,181,159,108,34}}}
	}};
	double mur = 213;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {128,253,1};
	assert( check(test+" Test 18", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{186,114,61,177,31,72,219},{121,188,166,53,254,130,51},{5,173,185,164,205,222,151},{208,199,198,142,28,164,2},{198,235,116,51,248,164,59},{140,10,145,241,215,57,182},{20,100,3,206,10,246,85}}},
		{{{174,205,230,235,114,117,188},{208,204,137,20,207,184,17},{99,29,51,60,94,96,217},{32,114,175,246,31,114,19},{221,147,217,208,50,225,70},{149,99,18,89,39,80,207},{126,196,234,141,221,126,117}}},
		{{{251,111,215,23,109,86,26},{16,70,158,41,72,54,74},{38,222,214,79,64,84,183},{49,178,167,33,109,204,177},{114,185,46,87,58,222,115},{143,179,82,141,84,174,250},{242,201,26,111,123,146,126}}},
		{{{131,197,58,148,21,52,194},{4,145,123,184,4,73,89},{156,37,82,145,85,180,120},{0,132,140,25,166,11,193},{212,200,78,102,106,158,6},{136,198,109,188,16,31,54},{190,34,16,71,74,169,112}}},
		{{{246,159,196,154,35,53,174},{253,97,211,105,196,250,38},{54,46,30,193,209,115,194},{241,130,50,109,76,194,17},{9,82,250,9,48,118,218},{204,64,246,211,21,232,95},{45,151,141,166,221,122,198}}},
		{{{178,177,21,230,66,239,122},{239,216,161,30,93,135,46},{254,135,1,143,143,5,216},{135,114,195,24,61,31,150},{168,162,112,183,178,171,166},{234,110,225,49,199,160,144},{26,142,72,83,243,149,163}}},
		{{{77,86,120,173,196,221,156},{186,60,25,4,236,24,22},{34,93,165,91,142,19,126},{7,203,149,113,39,39,121},{25,226,149,112,47,50,105},{11,253,188,200,215,71,220},{69,25,181,78,67,245,107}}}
	}};
	double mur = 103;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 19", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{227,72,56,55,254,43,40},{211,216,78,163,215,238,190},{33,39,160,83,32,17,238},{113,248,96,240,193,187,223},{39,175,174,129,214,133,30},{210,152,85,63,247,149,6},{205,17,124,249,215,121,250}}},
		{{{153,109,251,153,55,212,29},{196,152,126,180,212,109,9},{137,114,250,7,220,76,56},{206,176,182,151,59,29,142},{28,73,82,101,191,254,110},{36,37,8,248,17,101,89},{65,193,113,122,48,1,78}}},
		{{{165,77,183,219,13,59,89},{120,26,231,203,246,60,8},{162,242,90,118,167,19,80},{204,154,54,50,174,201,176},{23,122,208,81,29,157,0},{101,212,98,16,173,26,143},{123,64,160,154,114,44,92}}},
		{{{136,53,78,138,240,150,254},{241,99,75,7,59,33,199},{156,97,91,78,176,202,150},{85,92,60,16,7,237,173},{7,233,130,105,231,82,153},{223,235,164,210,234,5,102},{227,114,11,140,221,252,163}}},
		{{{151,90,226,107,24,101,145},{123,44,150,69,76,79,90},{98,143,188,122,216,163,41},{102,179,120,153,15,146,240},{129,84,175,102,31,172,21},{77,76,99,76,235,80,169},{245,24,143,246,188,199,166}}},
		{{{33,150,74,122,158,120,160},{47,71,202,0,79,143,248},{101,30,219,65,137,13,176},{95,2,87,234,166,220,67},{142,10,190,203,117,221,172},{251,110,0,2,211,94,225},{187,170,139,79,37,209,147}}},
		{{{85,39,218,240,63,201,136},{241,145,106,140,23,236,66},{64,36,241,92,57,13,134},{223,93,84,92,53,247,124},{219,222,227,212,132,105,194},{66,84,4,174,24,198,148},{1,179,236,184,140,148,201}}}
	}};
	double mur = 207;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 20", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{92,218,194,90,146,196,85},{12,152,58,187,176,134,20},{21,206,179,244,185,113,98},{31,25,148,9,203,57,119},{52,136,199,17,238,54,143},{101,110,54,220,74,51,74},{186,165,104,150,67,87,251}}},
		{{{202,66,102,104,30,244,89},{237,168,133,21,200,148,22},{192,223,83,29,209,30,222},{60,55,94,236,154,232,251},{15,230,20,100,130,237,190},{63,187,227,230,3,0,225},{238,229,50,182,187,142,117}}},
		{{{184,240,214,32,142,31,142},{46,26,221,114,153,226,108},{237,160,106,116,140,99,24},{54,61,234,37,79,252,0},{191,122,144,246,63,108,130},{225,178,140,163,83,145,57},{54,68,143,248,108,116,105}}},
		{{{233,0,237,76,237,80,72},{3,3,155,160,3,25,58},{17,31,43,18,174,63,135},{166,185,110,162,60,217,155},{231,18,197,163,206,199,107},{214,49,50,9,64,235,125},{165,82,155,69,13,5,51}}},
		{{{82,135,130,209,223,17,110},{124,216,34,44,214,180,223},{16,133,64,112,241,206,11},{118,190,81,30,44,155,119},{174,71,151,42,61,14,116},{124,172,208,141,8,134,251},{199,108,248,105,138,56,3}}},
		{{{190,122,108,91,159,13,19},{125,69,101,18,117,135,100},{204,175,227,150,126,183,181},{49,244,183,116,165,106,2},{163,248,200,169,228,214,177},{188,214,185,179,232,219,16},{132,108,26,84,114,69,24}}},
		{{{225,163,64,212,193,63,111},{202,26,185,152,2,172,212},{179,179,102,193,242,254,231},{107,101,204,230,31,245,107},{90,63,191,198,10,110,11},{165,249,45,203,200,5,214},{251,248,74,4,51,186,153}}}
	}};
	double mur = 204;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 21", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{251,45,3,238,78,64,97},{92,205,133,133,208,152,69},{74,31,231,190,136,33,177},{0,79,46,203,211,97,79},{28,53,41,89,176,197,164},{179,59,56,249,32,24,36},{103,5,230,81,188,41,119}}},
		{{{140,2,68,217,206,47,100},{11,158,193,45,34,104,136},{242,45,20,79,37,147,133},{51,151,95,196,95,141,163},{235,15,105,141,254,153,160},{48,22,188,96,203,124,14},{248,228,239,42,55,244,183}}},
		{{{167,155,81,98,129,88,203},{42,77,160,18,28,30,37},{187,237,234,129,228,253,165},{32,211,69,6,138,120,208},{141,107,130,27,120,124,128},{57,54,134,81,186,185,103},{149,15,235,51,200,5,89}}},
		{{{2,117,74,26,224,233,230},{63,125,172,172,162,110,59},{239,72,239,244,151,125,252},{238,238,120,129,212,29,201},{183,233,141,128,149,98,60},{60,223,238,140,226,129,231},{111,46,171,15,248,143,92}}},
		{{{205,213,222,22,158,82,167},{34,142,161,81,27,136,61},{18,22,144,164,198,4,102},{9,186,244,197,241,120,5},{124,21,111,69,116,107,201},{198,233,170,6,201,40,50},{65,154,213,61,24,246,40}}},
		{{{212,189,169,243,75,96,176},{25,73,69,199,132,101,158},{166,71,65,243,158,15,36},{214,173,61,104,222,127,200},{222,206,66,94,191,18,67},{202,196,124,94,131,178,116},{61,92,210,1,225,142,179}}},
		{{{79,245,251,194,100,110,170},{205,100,186,250,218,34,49},{22,241,79,2,62,147,250},{129,106,214,28,239,237,121},{160,97,162,212,3,77,185},{26,64,197,1,194,101,35},{147,41,4,196,41,77,2}}}
	}};
	double mur = 25;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 22", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{117,142,107,177,97,172,172},{91,71,76,29,217,7,37},{100,226,167,127,123,166,109},{4,213,246,83,106,157,253},{123,222,41,247,84,161,24},{246,23,118,187,70,109,95},{215,159,233,101,237,234,132}}},
		{{{122,226,222,179,154,123,86},{41,15,191,178,205,154,247},{9,26,60,48,23,234,70},{112,57,238,77,95,205,21},{79,79,78,117,254,39,98},{196,228,88,52,32,0,202},{10,7,245,106,77,161,69}}},
		{{{251,212,51,118,194,200,125},{40,231,193,227,118,218,192},{57,155,108,25,93,127,28},{42,135,19,96,235,82,234},{51,252,140,159,238,157,39},{248,116,79,152,245,71,236},{52,38,135,45,95,9,25}}},
		{{{83,44,218,46,252,88,247},{208,169,61,251,39,68,76},{241,102,71,23,202,228,208},{227,239,151,140,170,216,216},{211,51,234,156,197,83,140},{101,160,151,152,138,63,135},{128,241,73,160,250,165,184}}},
		{{{65,102,169,228,112,126,121},{192,194,50,95,159,162,222},{88,136,56,154,192,9,241},{111,202,134,22,10,99,185},{12,68,27,113,121,32,238},{201,198,118,65,48,36,250},{192,135,103,144,154,159,27}}},
		{{{41,130,9,18,114,44,33},{242,169,97,55,73,141,139},{128,243,194,170,12,83,5},{94,143,254,59,210,202,3},{17,8,242,189,131,137,157},{204,77,243,99,33,28,243},{246,98,5,46,176,254,74}}},
		{{{34,139,93,196,215,198,67},{12,56,247,134,57,148,120},{108,35,51,32,128,16,70},{23,227,196,165,149,184,138},{133,25,68,132,87,30,59},{66,235,253,168,74,74,106},{239,114,141,121,247,44,251}}}
	}};
	double mur = 133;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 23", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{239,243,104,195,252,66,85},{28,79,46,47,114,33,14},{233,182,134,241,95,190,189},{141,52,96,230,99,57,247},{104,95,13,49,40,145,51},{199,52,77,153,14,141,253},{252,90,95,214,40,83,178}}},
		{{{197,120,175,190,71,212,63},{76,138,4,57,21,43,218},{224,71,137,243,96,5,45},{213,135,78,247,109,225,208},{37,107,151,122,13,251,156},{235,10,108,224,9,111,154},{216,22,79,252,143,78,99}}},
		{{{66,116,160,58,191,2,130},{109,9,241,27,87,195,165},{230,185,251,137,173,165,207},{71,56,19,69,59,185,153},{32,155,174,2,103,65,191},{160,110,254,100,236,144,104},{153,36,8,150,32,145,21}}},
		{{{6,141,153,196,119,125,209},{31,140,246,9,214,132,131},{41,203,96,216,29,143,220},{187,69,152,159,10,159,123},{193,11,66,243,225,60,115},{204,29,162,72,215,29,233},{222,185,77,245,110,219,84}}},
		{{{220,250,23,122,245,83,91},{11,62,84,233,188,226,63},{77,253,157,66,230,131,103},{182,152,158,105,12,252,207},{110,51,65,180,200,232,45},{152,186,153,167,204,87,240},{85,177,168,221,166,7,8}}},
		{{{26,218,23,37,242,161,218},{29,24,50,175,93,46,21},{6,236,175,209,114,132,209},{241,167,219,53,86,139,114},{237,161,144,222,181,191,166},{126,45,102,206,206,108,170},{105,151,86,177,26,122,230}}},
		{{{193,28,210,108,80,204,235},{0,90,230,193,71,199,154},{111,223,182,247,15,171,82},{3,28,101,217,80,176,0},{203,85,134,241,41,243,10},{129,53,43,187,163,98,75},{158,179,117,184,215,236,183}}}
	}};
	double mur = 164;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 24", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{40,132,121,215,117,152,149},{82,135,44,133,113,2,7},{210,140,229,121,230,12,47},{181,0,95,55,253,246,173},{130,142,217,114,223,101,124},{15,148,245,26,229,30,54},{215,81,53,117,203,8,68}}},
		{{{180,50,36,159,100,116,149},{183,29,142,10,150,112,156},{61,206,140,174,19,75,173},{233,20,48,62,219,211,57},{248,15,137,109,40,17,43},{197,206,239,107,114,159,247},{242,7,107,136,231,36,59}}},
		{{{224,172,162,32,3,64,141},{138,89,130,205,134,13,52},{145,230,226,50,95,178,151},{136,158,42,178,182,220,210},{188,65,194,84,253,248,136},{144,225,100,23,164,114,48},{247,153,73,46,109,27,53}}},
		{{{124,161,203,19,158,211,62},{5,165,84,30,133,232,182},{103,203,233,232,87,231,5},{76,175,204,78,224,22,2},{84,181,222,199,118,237,71},{62,254,127,42,104,154,242},{2,52,59,253,217,228,72}}},
		{{{113,241,104,34,209,20,253},{79,204,233,219,56,163,102},{139,112,15,119,87,192,86},{118,213,181,214,31,188,203},{187,55,185,38,169,73,115},{24,170,178,152,137,74,199},{96,249,76,153,104,49,197}}},
		{{{85,131,117,158,186,196,29},{241,218,4,143,124,44,85},{243,117,207,137,99,20,29},{116,187,37,29,158,29,207},{251,85,132,118,22,134,72},{166,95,194,71,176,3,162},{227,104,3,51,58,218,75}}},
		{{{56,80,242,58,190,118,4},{46,33,119,72,49,146,121},{202,119,150,158,221,216,62},{216,138,84,171,218,102,93},{164,4,189,216,87,178,51},{66,217,167,247,129,132,175},{88,93,77,169,49,166,119}}}
	}};
	double mur = 11;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 25", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{230,46,190,198,129,127,226},{11,16,118,13,81,203,212},{162,19,32,83,73,5,68},{128,194,204,181,228,11,60},{63,208,232,218,67,154,236},{31,42,68,157,103,7,179},{202,91,5,171,234,134,86}}},
		{{{50,128,121,222,228,14,19},{182,76,121,209,182,248,44},{90,228,188,85,67,88,156},{106,143,132,59,4,111,31},{224,183,84,186,111,62,157},{148,29,31,74,192,76,153},{136,59,239,83,57,8,24}}},
		{{{117,205,88,90,8,148,169},{35,237,169,66,127,35,131},{153,143,23,195,228,178,146},{180,83,33,186,81,110,189},{103,160,156,124,16,11,151},{172,244,157,76,35,52,22},{157,224,112,156,173,156,32}}},
		{{{227,6,29,68,28,172,75},{223,56,226,253,45,214,55},{197,31,114,135,118,161,57},{1,125,134,8,199,124,29},{132,142,151,239,218,131,220},{9,70,249,229,217,14,105},{183,183,5,192,6,148,139}}},
		{{{60,4,219,253,32,34,92},{187,97,143,135,226,250,11},{216,95,8,145,4,224,95},{97,114,55,33,134,182,5},{72,85,66,2,90,226,165},{100,188,120,154,43,201,242},{82,244,36,62,146,150,35}}},
		{{{74,57,243,43,245,122,181},{38,102,92,168,240,246,108},{176,54,162,152,150,168,251},{73,135,162,76,204,169,101},{47,159,143,84,169,100,81},{68,119,112,137,249,2,206},{77,199,184,217,157,22,251}}},
		{{{42,236,57,252,17,98,160},{222,197,189,175,168,127,251},{45,239,44,242,133,170,227},{149,101,78,58,33,240,131},{109,86,213,154,228,79,19},{120,6,176,143,61,54,195},{214,43,65,207,113,47,23}}}
	}};
	double mur = 83;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 26", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{57,54,23,166,197,111,4},{114,199,22,45,200,253,237},{252,245,243,253,38,95,6},{41,226,111,171,89,119,191},{220,151,12,25,40,83,157},{123,89,113,108,186,57,32},{220,167,111,99,246,47,102}}},
		{{{215,39,35,95,216,140,16},{138,110,86,85,196,108,104},{225,175,47,10,144,212,109},{114,204,220,33,112,194,175},{204,43,240,90,225,180,18},{193,182,44,181,230,79,242},{85,66,31,22,237,151,53}}},
		{{{41,201,114,129,26,158,36},{223,29,163,127,62,220,157},{10,46,160,30,3,82,28},{43,127,198,30,250,196,163},{101,156,66,56,175,54,112},{94,57,27,249,179,151,242},{176,38,87,226,80,80,108}}},
		{{{189,163,230,177,130,39,95},{248,24,62,43,98,100,163},{61,209,49,50,171,253,136},{137,96,24,66,108,139,127},{237,25,213,104,203,7,55},{252,161,169,254,164,162,214},{252,157,159,22,249,47,106}}},
		{{{170,29,65,37,174,81,165},{185,49,152,28,92,220,239},{202,85,133,81,1,215,233},{115,62,120,7,187,238,193},{31,141,55,43,29,43,90},{83,175,32,199,39,229,237},{244,123,71,163,80,96,230}}},
		{{{135,103,185,102,5,42,98},{213,215,0,64,32,172,195},{251,48,54,194,163,0,208},{157,57,39,14,231,193,58},{100,246,154,0,230,75,177},{192,251,224,82,226,60,79},{73,116,6,209,6,90,141}}},
		{{{244,139,190,128,12,138,87},{51,39,73,243,188,50,1},{11,32,174,24,218,48,185},{239,4,127,197,219,140,151},{254,55,239,194,25,201,10},{140,175,92,224,95,76,43},{29,240,102,158,115,153,65}}}
	}};
	double mur = 91;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,137,0};
	assert( check(test+" Test 27", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{163,52,17,95,236,28,212},{12,57,170,164,56,144,3},{15,19,101,63,210,145,230},{179,60,49,184,201,16,234},{166,150,2,123,142,189,37},{161,170,23,69,145,219,242},{124,111,251,29,121,4,208}}},
		{{{222,120,13,179,26,101,99},{220,120,228,108,245,89,184},{198,69,168,2,105,193,211},{235,112,54,214,82,67,163},{83,80,53,162,132,115,242},{125,57,244,240,31,103,104},{67,55,122,137,144,189,141}}},
		{{{91,102,42,142,245,43,142},{151,172,40,80,109,234,5},{233,247,88,51,189,152,229},{245,3,246,70,220,42,233},{39,58,27,196,218,248,110},{53,247,200,184,193,166,69},{30,5,23,141,186,89,158}}},
		{{{54,59,108,18,189,151,158},{250,54,218,203,15,65,243},{149,189,130,212,216,208,224},{168,219,43,151,44,1,206},{186,164,33,124,165,145,116},{225,146,204,127,90,183,125},{33,221,26,157,22,93,165}}},
		{{{9,3,163,203,4,185,95},{65,63,84,73,123,43,3},{109,186,97,0,66,150,115},{247,18,234,191,191,140,22},{156,122,33,0,104,162,144},{202,51,163,235,246,16,176},{57,82,43,100,176,79,145}}},
		{{{156,134,246,242,5,6,161},{78,95,239,74,166,249,139},{237,86,139,101,185,66,117},{229,67,189,225,188,41,133},{160,88,6,141,7,250,144},{55,125,253,199,80,178,119},{180,180,26,17,123,147,179}}},
		{{{53,60,49,192,19,240,1},{216,217,218,50,222,219,94},{118,154,26,41,97,143,50},{135,136,163,206,223,166,21},{2,250,127,242,111,204,43},{161,98,168,213,26,229,161},{247,184,52,18,249,23,142}}}
	}};
	double mur = 70;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {127,253,1};
	assert( check(test+" Test 28", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{156,123,191,250,152,101,227},{168,83,215,48,26,148,231},{96,76,193,34,47,216,196},{43,63,242,176,96,238,138},{107,153,13,40,250,215,107},{41,96,41,192,55,207,63},{75,128,121,240,231,79,150}}},
		{{{97,62,121,186,137,15,223},{237,141,92,100,79,173,59},{11,2,153,206,139,245,115},{159,135,217,2,87,192,69},{183,4,68,179,117,235,89},{131,200,162,128,131,116,224},{70,216,252,48,112,103,116}}},
		{{{2,85,57,93,230,139,167},{216,63,1,61,4,234,147},{190,93,184,191,218,69,101},{185,180,37,149,38,178,187},{93,125,154,213,179,101,71},{108,243,184,67,209,252,42},{43,192,237,157,172,126,34}}},
		{{{153,67,59,95,32,52,10},{190,162,221,47,147,26,168},{187,112,93,164,52,145,62},{224,159,149,144,169,29,125},{21,239,63,248,118,107,169},{83,56,61,213,107,145,71},{162,242,108,133,73,27,148}}},
		{{{233,173,162,33,135,34,152},{164,92,242,165,146,140,116},{227,203,242,41,234,22,179},{113,92,5,177,235,131,208},{175,111,54,170,195,62,18},{43,12,205,174,23,95,148},{77,247,30,217,183,150,155}}},
		{{{47,236,31,81,144,150,68},{204,17,63,1,230,69,50},{92,75,207,3,195,39,125},{131,128,114,104,145,252,170},{109,83,55,228,196,131,240},{145,55,135,18,10,122,80},{44,149,170,92,93,162,131}}},
		{{{147,180,51,26,176,115,42},{224,170,218,139,76,201,81},{19,90,251,139,175,157,227},{26,128,185,14,192,84,249},{113,144,137,85,41,27,189},{194,229,188,172,152,50,106},{202,49,14,8,244,237,154}}}
	}};
	double mur = 193;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,115,0};
	assert( check(test+" Test 29", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{131,7,86,218,37,148,96},{155,167,156,96,219,192,105},{64,25,134,140,222,210,212},{186,170,149,235,249,1,231},{133,73,66,13,225,75,28},{187,157,243,61,247,43,176},{74,46,212,51,148,230,7}}},
		{{{84,173,33,95,219,3,61},{136,127,243,128,204,76,182},{58,214,204,180,33,67,207},{85,252,157,36,134,109,204},{179,214,253,135,189,178,199},{49,199,19,218,189,130,236},{230,118,3,192,31,233,164}}},
		{{{62,33,112,30,252,167,88},{196,226,178,74,182,159,65},{244,98,152,113,74,108,165},{194,23,91,202,11,176,188},{3,154,18,248,187,238,83},{37,108,218,194,140,225,163},{145,208,66,214,238,210,136}}},
		{{{81,58,116,184,13,108,55},{73,173,5,178,106,219,57},{211,205,105,234,105,29,101},{111,63,132,219,134,108,58},{163,151,142,213,108,228,221},{160,32,211,138,61,16,252},{105,74,90,191,5,77,150}}},
		{{{20,154,214,19,53,232,77},{57,24,174,207,221,217,234},{21,202,132,226,224,242,121},{171,167,19,217,109,231,112},{191,239,93,222,228,195,198},{21,221,207,140,38,242,243},{145,107,78,212,209,3,76}}},
		{{{174,178,127,211,120,94,40},{112,8,142,199,70,3,44},{47,223,38,137,137,154,246},{72,43,150,89,191,137,213},{193,6,167,154,111,89,81},{82,10,2,24,69,29,103},{9,202,42,146,157,148,38}}},
		{{{246,201,199,185,168,147,148},{166,19,125,145,109,248,129},{77,5,194,247,236,13,62},{86,113,138,20,76,175,175},{241,86,250,86,15,15,40},{76,1,45,132,126,203,80},{66,5,62,209,172,30,125}}}
	}};
	double mur = 36;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 30", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{87,202,43,93,16,154,250},{66,147,135,6,36,140,64},{210,131,127,254,220,186,148},{237,250,27,169,233,149,89},{242,148,157,237,207,249,241},{161,240,222,219,178,141,163},{214,129,77,158,46,86,169}}},
		{{{229,211,229,254,187,91,39},{17,166,177,239,57,173,172},{57,88,42,95,75,98,65},{8,188,248,25,30,80,118},{211,12,169,44,119,238,253},{38,106,120,122,209,224,250},{73,196,148,111,186,139,182}}},
		{{{5,3,160,135,59,15,198},{146,6,25,1,40,13,32},{251,70,127,63,132,97,66},{130,122,146,17,180,120,10},{142,61,141,237,139,32,36},{196,187,156,1,162,238,196},{15,47,148,119,26,70,229}}},
		{{{86,211,216,195,226,219,9},{87,94,243,91,57,64,7},{136,162,118,234,172,39,27},{45,25,16,10,177,209,113},{40,134,55,55,100,122,53},{143,155,172,254,210,220,109},{202,133,17,60,183,178,207}}},
		{{{233,61,201,76,201,136,126},{234,54,178,35,226,159,184},{126,34,108,25,127,12,229},{7,23,59,44,117,241,135},{186,160,17,228,254,97,133},{234,79,215,163,144,68,13},{29,123,182,252,154,14,116}}},
		{{{220,226,63,9,59,213,197},{229,130,9,170,62,151,22},{137,111,104,13,49,73,163},{120,127,3,126,183,51,218},{113,204,75,182,110,248,203},{129,19,88,203,144,216,72},{167,6,75,130,103,249,93}}},
		{{{14,77,110,91,149,141,22},{76,120,249,177,192,40,131},{5,31,56,138,218,231,2},{251,114,228,142,251,195,212},{248,154,84,187,9,13,96},{251,214,125,169,231,132,136},{13,38,161,4,132,43,160}}}
	}};
	double mur = 13;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 31", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{130,53,75,106,13,57,22},{30,73,173,100,124,56,246},{4,159,222,55,63,148,26},{163,68,32,242,151,209,77},{45,94,84,185,121,30,53},{210,65,222,201,68,111,10},{47,236,46,97,214,61,142}}},
		{{{146,156,168,125,126,63,183},{114,250,48,183,167,236,252},{87,124,42,141,222,57,246},{20,196,101,198,133,129,234},{172,131,181,167,3,158,246},{80,72,170,244,148,181,104},{123,205,251,93,4,227,76}}},
		{{{246,22,52,55,115,13,7},{248,193,123,232,175,215,199},{100,247,234,46,56,204,236},{32,220,179,182,210,24,48},{136,18,186,206,222,182,193},{64,209,166,85,195,199,13},{127,92,49,134,144,74,47}}},
		{{{242,252,17,129,68,44,115},{124,219,103,8,150,197,18},{80,146,169,223,189,18,165},{16,191,17,59,195,51,114},{13,51,215,101,99,116,67},{249,230,53,80,94,52,52},{155,158,46,124,222,221,152}}},
		{{{197,233,32,206,73,112,106},{214,216,140,32,27,56,189},{250,254,46,86,177,9,254},{121,9,94,58,180,21,80},{211,60,187,56,131,28,79},{54,218,10,84,239,235,117},{190,93,74,215,48,140,23}}},
		{{{224,224,127,251,178,240,175},{191,42,20,110,92,34,73},{79,52,31,200,178,78,241},{72,66,134,26,221,5,91},{233,168,111,226,242,233,7},{237,174,226,91,93,170,102},{91,206,16,157,120,141,165}}},
		{{{71,45,72,38,234,44,123},{96,200,76,175,120,146,54},{147,129,83,128,231,136,228},{86,86,49,202,116,157,249},{114,37,216,194,209,15,108},{223,40,167,78,33,139,38},{109,107,62,193,242,69,224}}}
	}};
	double mur = 165;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 32", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{250,123,129,144,111,73,143},{57,158,0,37,100,33,25},{171,150,222,88,231,150,20},{143,230,23,207,75,106,44},{54,150,243,199,220,142,180},{66,26,175,142,201,196,77},{43,161,235,7,231,10,242}}},
		{{{59,177,149,183,235,193,19},{236,247,135,86,14,233,245},{122,135,26,174,6,98,175},{228,244,38,37,65,208,22},{253,155,16,140,25,182,243},{228,90,179,172,240,187,86},{160,128,71,157,106,151,160}}},
		{{{62,117,123,18,48,153,220},{207,69,188,152,145,205,144},{169,178,231,198,28,57,211},{17,88,60,30,132,249,198},{162,32,238,190,142,88,31},{141,133,185,1,149,71,0},{21,28,192,117,238,143,114}}},
		{{{47,234,20,254,68,67,71},{80,98,47,222,168,253,231},{66,158,218,64,68,163,178},{227,37,178,1,47,197,4},{231,149,148,84,96,221,57},{242,192,127,108,7,31,188},{69,51,6,4,70,98,219}}},
		{{{190,251,221,82,77,50,120},{221,212,162,72,70,226,209},{130,59,32,225,23,54,231},{26,64,248,250,97,138,21},{156,193,82,187,119,238,56},{26,199,48,94,86,36,83},{121,87,9,224,200,73,87}}},
		{{{227,102,238,216,170,30,122},{187,59,76,208,160,86,69},{132,235,111,136,46,171,15},{250,177,208,86,187,207,32},{45,176,83,252,205,169,100},{99,102,160,106,80,191,102},{29,196,204,108,189,141,61}}},
		{{{240,74,112,181,156,152,7},{120,195,159,158,249,145,151},{70,113,153,178,16,124,229},{106,5,10,83,14,108,206},{47,146,128,156,152,171,114},{194,216,220,14,105,16,223},{12,155,31,86,85,7,15}}}
	}};
	double mur = 114;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 33", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{194,246,9,64,133,122,245},{97,80,77,60,39,149,30},{107,102,82,106,206,235,0},{250,21,33,196,116,136,78},{0,81,31,136,27,64,187},{158,68,2,200,154,215,108},{42,118,0,196,54,133,49}}},
		{{{19,63,135,18,179,81,29},{37,147,122,180,180,112,124},{158,205,175,65,89,1,201},{143,127,40,242,186,157,225},{182,86,131,210,130,250,18},{200,158,237,214,122,125,39},{13,197,208,59,132,199,124}}},
		{{{217,68,0,3,49,51,225},{208,55,122,43,147,98,9},{89,100,238,80,24,93,252},{52,185,117,57,41,42,177},{78,72,104,71,186,173,62},{40,140,226,176,2,104,136},{26,128,97,133,13,101,228}}},
		{{{211,15,50,111,49,94,214},{205,19,160,112,167,155,253},{185,243,117,251,225,167,107},{182,178,165,155,246,88,16},{227,158,206,4,89,87,219},{213,114,61,69,142,11,127},{15,174,82,209,105,30,66}}},
		{{{62,40,9,1,227,183,169},{124,128,240,196,89,192,167},{219,35,163,157,149,202,194},{74,245,158,23,242,107,193},{48,105,65,138,80,76,128},{114,194,56,87,88,219,89},{178,214,128,201,234,105,244}}},
		{{{45,29,28,141,149,36,11},{205,191,144,108,56,228,239},{224,244,200,224,101,41,63},{106,138,112,185,64,136,163},{224,106,210,27,106,109,169},{250,95,83,228,171,67,73},{95,175,97,21,137,102,131}}},
		{{{119,201,162,156,155,69,139},{195,237,238,0,50,200,153},{184,218,117,36,61,49,215},{76,39,65,231,39,83,249},{149,187,241,57,20,139,178},{151,232,66,13,98,177,181},{148,239,48,31,1,174,185}}}
	}};
	double mur = 19;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 34", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{204,254,43,136,204,19,146},{58,59,227,186,5,116,131},{121,132,38,234,177,146,2},{152,250,166,220,109,31,182},{205,89,4,153,46,234,252},{218,156,181,168,148,75,157},{223,133,77,68,81,92,97}}},
		{{{44,110,77,10,17,230,168},{97,231,123,79,203,122,199},{179,22,215,38,219,249,83},{61,32,230,88,129,211,252},{18,55,69,116,188,212,149},{239,29,164,65,175,5,55},{50,3,21,18,20,120,242}}},
		{{{2,130,165,44,138,53,198},{5,167,91,218,159,224,136},{25,212,2,58,33,32,89},{28,197,30,245,5,105,26},{237,180,234,174,93,32,41},{163,44,136,49,42,97,70},{93,115,228,155,221,130,249}}},
		{{{197,49,49,140,213,84,183},{82,184,115,223,180,172,251},{91,200,28,98,197,109,41},{14,188,104,66,26,46,220},{220,184,249,45,58,74,221},{145,244,23,9,142,218,191},{37,111,90,235,48,71,87}}},
		{{{3,76,205,29,57,94,212},{176,83,232,80,99,163,237},{175,135,234,70,72,36,94},{16,212,117,191,185,211,50},{131,247,114,62,37,239,154},{176,251,69,98,26,55,102},{22,129,138,194,238,253,201}}},
		{{{63,138,109,142,177,92,190},{199,227,232,63,216,9,137},{3,113,240,162,246,133,201},{97,33,138,246,43,79,31},{131,88,94,144,1,131,108},{178,124,134,73,17,33,212},{95,205,23,77,230,168,39}}},
		{{{126,20,121,128,75,78,134},{145,226,4,90,199,90,220},{222,193,203,215,200,180,2},{150,20,87,1,71,29,172},{47,243,137,156,56,101,248},{78,173,174,93,107,181,35},{154,192,8,182,19,83,80}}}
	}};
	double mur = 239;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 35", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{168,121,11,59,10,199,67},{31,122,47,114,80,218,45},{103,244,180,110,34,79,65},{170,86,193,33,7,66,19},{174,120,5,85,30,212,190},{133,11,138,107,149,0,97},{82,57,66,101,241,130,128}}},
		{{{87,160,41,196,79,177,183},{35,142,28,117,61,144,142},{184,91,164,222,47,87,39},{106,10,191,161,92,96,59},{70,173,236,187,60,119,56},{172,201,80,158,25,130,161},{126,37,57,200,46,3,86}}},
		{{{170,188,69,32,131,187,67},{113,242,26,115,171,231,131},{51,22,229,219,59,11,9},{129,64,87,228,54,89,187},{248,198,216,62,35,223,187},{47,40,164,147,167,46,243},{9,69,242,7,132,189,5}}},
		{{{12,41,157,233,232,4,145},{171,159,212,116,86,189,166},{110,33,37,204,142,91,30},{198,56,27,83,221,218,166},{212,212,48,14,69,89,216},{97,35,232,62,19,26,138},{196,99,227,29,48,71,246}}},
		{{{243,242,190,30,112,247,111},{54,38,146,205,145,176,28},{157,247,105,44,71,71,149},{68,219,5,77,172,89,241},{138,178,192,25,205,234,215},{112,10,124,153,163,65,241},{70,128,226,178,112,111,122}}},
		{{{29,254,230,248,231,194,210},{61,68,107,239,58,94,120},{11,151,97,124,129,109,210},{37,1,95,147,135,77,110},{89,163,172,234,250,224,193},{198,150,227,129,218,214,132},{177,197,72,210,170,75,142}}},
		{{{115,43,39,164,219,15,15},{13,124,227,250,152,66,206},{215,147,51,210,139,46,80},{57,146,88,112,252,235,183},{174,182,86,74,51,133,203},{226,141,172,123,163,122,226},{80,85,190,27,45,145,146}}}
	}};
	double mur = 87;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 36", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{118,49,239,146,181,237,45},{3,187,177,200,46,184,40},{142,11,42,248,119,112,19},{55,215,60,138,116,150,231},{166,61,140,195,220,23,93},{51,167,7,13,137,95,8},{189,103,147,53,127,142,128}}},
		{{{170,140,94,12,77,67,166},{126,151,7,90,210,227,64},{92,40,172,26,140,164,195},{241,65,168,248,149,21,148},{241,199,69,108,223,130,183},{182,153,107,159,250,71,236},{231,190,168,75,158,144,186}}},
		{{{187,58,166,139,236,90,10},{90,153,182,72,158,57,195},{132,236,139,54,230,216,151},{60,162,159,39,35,86,52},{88,61,103,131,62,246,208},{17,29,227,104,152,132,58},{118,73,68,79,68,145,45}}},
		{{{114,155,18,205,241,113,176},{67,212,15,242,39,39,50},{106,147,86,149,57,137,222},{207,83,246,211,196,135,196},{87,172,167,190,199,80,119},{191,176,172,31,99,64,236},{172,241,204,232,198,223,234}}},
		{{{79,144,84,95,180,248,26},{47,18,33,215,135,78,133},{197,249,189,117,134,193,225},{186,215,91,141,83,191,184},{36,184,101,127,7,84,220},{244,116,32,30,68,5,88},{4,128,211,144,96,46,82}}},
		{{{195,96,122,76,230,134,31},{56,119,78,53,188,59,83},{8,236,47,12,17,38,129},{69,132,17,83,217,64,63},{36,125,148,150,3,19,140},{243,188,221,14,26,115,76},{203,140,7,182,5,144,193}}},
		{{{57,49,151,65,47,0,253},{203,73,192,189,104,206,215},{242,136,32,11,191,211,109},{95,32,164,249,99,32,152},{28,39,24,84,242,164,138},{252,91,203,143,184,61,133},{54,170,56,52,0,208,68}}}
	}};
	double mur = 139;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 37", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{41,246,87,29,69,147,150},{137,167,163,55,71,223,75},{204,70,101,109,69,209,166},{168,235,221,16,26,222,231},{214,121,217,58,63,171,221},{92,88,148,149,241,84,125},{251,155,71,201,38,239,154}}},
		{{{92,126,70,190,7,128,57},{191,143,77,12,77,44,26},{112,98,116,34,154,75,156},{137,121,221,201,51,139,35},{171,43,231,246,8,186,173},{208,72,132,70,42,27,173},{194,103,1,167,187,121,218}}},
		{{{118,49,21,146,13,15,205},{16,109,52,106,144,189,195},{171,18,159,237,150,207,141},{148,202,150,25,207,158,148},{59,251,180,168,113,231,247},{175,30,153,195,186,217,14},{58,212,77,65,75,124,164}}},
		{{{22,86,154,104,24,137,68},{109,92,141,26,83,210,78},{105,69,82,91,241,22,158},{66,200,177,188,109,225,215},{174,206,230,78,31,136,143},{93,57,233,219,155,134,151},{175,213,226,8,96,142,211}}},
		{{{234,199,81,73,172,253,45},{35,247,103,234,75,198,248},{39,22,169,177,201,162,224},{1,220,14,107,161,97,49},{13,85,136,127,21,249,185},{218,86,201,102,144,55,79},{71,243,15,99,99,232,76}}},
		{{{21,105,160,130,102,245,163},{90,126,203,253,23,254,103},{17,221,234,198,174,248,127},{27,200,197,23,226,129,19},{218,201,74,26,50,182,251},{61,54,210,161,15,243,53},{128,12,136,183,27,250,8}}},
		{{{67,99,236,71,90,8,213},{82,62,103,152,238,205,58},{158,174,78,237,185,109,203},{8,142,212,51,235,79,80},{143,92,218,212,9,181,180},{2,153,179,186,17,19,151},{2,148,118,87,1,95,14}}}
	}};
	double mur = 223;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 38", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{30,64,194,209,102,137,124},{75,232,6,73,94,167,230},{232,67,58,184,54,196,60},{152,155,54,19,138,90,198},{96,14,5,221,133,139,76},{217,15,3,22,227,32,63},{85,1,185,120,147,47,142}}},
		{{{143,92,49,246,173,214,16},{237,155,212,237,169,12,14},{106,206,71,242,129,242,157},{240,187,3,101,246,222,141},{28,176,43,128,241,107,129},{63,17,134,161,10,168,131},{216,186,180,252,80,5,224}}},
		{{{126,128,235,96,167,252,38},{5,202,201,48,205,83,219},{40,117,97,243,120,56,167},{133,116,43,221,190,227,91},{239,92,187,139,217,58,140},{4,126,73,137,53,193,186},{89,125,204,53,123,83,216}}},
		{{{53,27,233,98,63,229,171},{208,123,176,232,162,144,111},{189,162,54,137,65,117,214},{61,219,237,236,104,100,200},{105,115,48,71,118,164,39},{64,163,30,188,79,46,46},{16,220,219,203,77,135,42}}},
		{{{29,158,116,30,134,162,156},{238,79,136,51,129,237,115},{244,159,156,187,34,243,195},{67,68,172,207,58,40,208},{115,86,242,252,253,59,124},{108,165,167,233,17,226,193},{146,94,221,223,234,229,84}}},
		{{{153,184,116,244,197,36,124},{125,238,6,5,119,242,49},{129,168,88,6,17,24,87},{135,217,72,235,105,15,4},{73,46,19,61,36,204,97},{176,134,226,74,196,115,192},{17,46,142,82,140,49,155}}},
		{{{172,81,29,103,101,198,26},{213,168,110,35,115,170,187},{115,240,189,192,155,179,253},{69,42,203,235,46,191,226},{130,125,194,13,53,148,124},{80,248,43,226,23,120,223},{108,116,238,51,117,10,138}}}
	}};
	double mur = 53;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 39", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{178,117,235,227,58,247,108},{167,137,43,105,142,191,98},{158,213,245,118,129,162,198},{208,101,187,68,197,153,60},{173,67,248,241,71,183,226},{41,208,45,149,139,57,196},{120,225,112,31,97,166,117}}},
		{{{208,130,201,8,84,195,211},{30,195,193,140,148,116,197},{190,14,90,28,99,136,245},{108,228,177,40,1,44,171},{244,184,184,222,43,148,40},{230,65,131,253,158,59,73},{145,136,244,9,143,254,96}}},
		{{{174,247,32,254,82,78,250},{104,49,164,76,75,85,26},{44,137,112,105,186,22,221},{23,135,113,165,46,174,130},{182,180,101,240,156,178,181},{157,193,88,41,233,18,142},{185,2,148,47,180,186,104}}},
		{{{15,233,229,209,77,199,98},{168,235,254,191,179,201,52},{55,6,33,50,52,101,207},{239,149,203,78,241,137,250},{165,187,187,44,14,215,51},{134,189,215,68,198,247,169},{121,70,64,239,103,90,96}}},
		{{{46,101,250,166,64,67,215},{33,86,12,55,212,141,84},{144,241,7,112,7,115,124},{193,73,174,84,16,77,103},{177,85,168,206,219,126,92},{74,159,224,211,16,203,140},{162,11,32,63,197,204,114}}},
		{{{117,254,187,49,87,164,218},{160,206,72,116,126,202,51},{161,217,198,9,125,54,29},{205,32,136,249,216,1,44},{254,112,25,97,212,117,92},{180,253,33,220,215,24,77},{89,115,173,50,106,209,169}}},
		{{{33,166,103,169,26,64,165},{245,15,49,221,79,54,1},{85,116,162,83,5,167,31},{240,172,68,67,196,189,22},{249,234,226,53,78,217,16},{132,238,247,224,139,238,162},{112,151,19,88,251,169,219}}}
	}};
	double mur = 124;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,150,0};
	assert( check(test+" Test 40", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{230,60,9,79,100,36,149},{43,122,207,8,151,37,47},{186,34,83,241,216,241,164},{125,230,96,142,207,8,165},{213,216,58,201,130,237,237},{92,207,146,244,43,106,39},{237,191,250,242,139,192,53}}},
		{{{123,237,65,161,218,175,162},{121,237,105,112,87,8,136},{185,115,162,75,212,78,149},{27,230,139,100,58,194,43},{30,149,10,11,16,131,44},{83,214,206,166,132,114,2},{211,122,216,238,116,69,76}}},
		{{{211,43,3,159,51,7,125},{38,92,176,237,4,235,199},{220,67,208,75,200,220,221},{102,142,108,217,150,123,108},{15,148,226,199,126,56,227},{125,227,20,210,76,136,177},{185,216,7,7,7,128,66}}},
		{{{92,107,113,209,225,5,150},{20,97,29,36,56,207,33},{184,136,59,173,26,236,246},{144,91,196,228,150,28,146},{235,48,4,105,100,213,44},{7,132,156,124,188,149,157},{215,178,82,155,11,138,136}}},
		{{{113,249,34,121,159,111,124},{117,198,102,199,74,179,228},{164,125,122,34,166,35,44},{88,115,0,87,0,116,87},{188,87,57,159,170,76,172},{236,16,47,254,145,166,185},{155,19,211,205,92,110,15}}},
		{{{211,199,25,196,17,161,75},{110,5,193,56,33,82,113},{141,2,237,170,23,4,147},{54,115,183,134,5,111,221},{123,106,144,207,150,76,58},{181,191,36,198,72,195,16},{239,5,236,215,141,183,103}}},
		{{{251,92,142,157,235,194,41},{165,211,217,224,202,153,175},{233,100,86,73,126,75,179},{234,138,116,18,39,83,194},{131,223,61,181,237,36,241},{167,120,109,217,123,106,81},{135,123,165,236,154,51,198}}}
	}};
	double mur = 132;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 41", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{34,248,142,227,167,147,243},{152,13,52,91,95,57,84},{84,45,181,64,39,20,224},{15,132,53,9,193,222,82},{48,138,251,100,221,216,134},{26,224,21,201,199,54,95},{107,28,91,10,148,238,95}}},
		{{{152,95,110,154,210,44,192},{139,167,229,112,246,162,187},{63,116,228,166,113,161,69},{78,29,41,234,194,187,216},{54,157,187,5,185,207,240},{161,93,49,212,79,118,182},{201,180,20,191,141,252,76}}},
		{{{49,203,16,82,60,85,240},{184,181,75,150,106,47,141},{140,176,84,194,128,70,30},{204,10,242,24,89,45,228},{216,146,34,32,180,33,180},{225,54,142,3,41,206,202},{247,17,24,8,142,141,202}}},
		{{{236,216,98,155,62,23,53},{154,128,6,10,111,135,237},{201,11,237,47,176,150,110},{59,202,66,220,5,228,185},{162,135,36,153,223,253,44},{250,42,91,79,201,155,131},{97,201,22,119,233,205,14}}},
		{{{79,223,125,205,246,20,85},{100,209,250,243,109,250,128},{151,136,145,55,128,220,16},{245,174,227,76,152,229,32},{43,95,114,51,158,208,22},{100,45,85,99,204,38,108},{94,111,207,254,43,58,63}}},
		{{{118,31,132,76,40,251,23},{159,60,235,234,147,56,144},{252,238,202,69,229,155,238},{238,219,125,208,242,32,88},{162,121,210,131,143,209,34},{208,121,97,72,167,237,33},{115,37,213,48,88,16,2}}},
		{{{138,106,41,75,231,156,95},{54,82,109,211,116,9,63},{9,186,64,183,163,136,40},{171,186,220,121,207,213,210},{90,236,112,163,93,207,246},{203,45,163,31,201,180,116},{132,105,240,17,246,53,102}}}
	}};
	double mur = 122;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 42", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{99,76,244,170,27,197,125},{125,133,113,127,45,4,103},{43,209,131,107,93,194,33},{222,163,167,176,6,232,59},{132,220,128,110,185,79,35},{76,166,225,96,120,119,173},{217,25,87,161,124,115,73}}},
		{{{198,25,254,132,136,18,214},{248,159,149,11,204,120,186},{242,44,157,204,181,55,152},{10,220,160,189,59,128,14},{3,185,198,183,107,139,163},{37,245,71,128,119,20,100},{121,4,31,242,226,193,228}}},
		{{{156,224,76,110,118,122,137},{37,89,97,88,9,133,34},{219,59,51,11,150,176,210},{152,240,84,203,51,209,82},{71,83,200,174,251,98,0},{227,173,238,242,216,46,151},{9,55,100,164,218,200,49}}},
		{{{71,80,215,239,183,151,228},{102,133,19,27,107,24,226},{206,45,217,6,12,198,27},{246,27,21,42,86,202,57},{140,111,201,33,55,209,153},{73,245,221,78,54,4,48},{152,80,59,205,209,65,238}}},
		{{{69,179,137,214,252,56,31},{39,77,249,178,214,101,236},{87,193,226,174,59,152,146},{42,79,176,238,223,62,47},{211,231,163,108,175,112,38},{34,170,43,114,87,156,11},{248,254,207,216,93,83,216}}},
		{{{229,237,60,143,245,237,57},{45,179,61,68,216,50,124},{252,204,86,25,82,47,63},{152,230,42,139,36,217,104},{119,248,13,130,99,38,146},{229,126,87,85,194,92,176},{29,184,60,104,65,75,56}}},
		{{{211,198,233,78,250,59,188},{170,201,160,85,24,73,230},{3,116,116,221,221,225,120},{173,59,195,49,126,118,18},{99,78,39,192,33,13,252},{72,197,174,238,75,211,126},{164,130,162,184,21,136,119}}}
	}};
	double mur = 241;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 43", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{163,16,235,144,96,188,6},{218,59,91,64,223,68,162},{194,177,136,223,113,203,161},{53,101,214,94,231,121,14},{159,150,27,164,58,10,222},{247,204,122,97,242,132,181},{170,96,130,51,22,72,253}}},
		{{{214,193,175,7,10,221,182},{222,56,167,1,157,128,176},{245,45,190,114,97,83,82},{157,21,73,142,12,245,202},{11,77,88,57,170,5,101},{95,169,224,8,68,182,105},{156,149,110,16,216,95,200}}},
		{{{14,139,102,237,82,244,67},{187,84,228,196,7,145,114},{126,211,242,26,40,63,198},{16,64,70,36,13,89,51},{30,192,191,154,38,226,202},{96,0,109,195,91,109,161},{185,105,150,235,39,93,92}}},
		{{{183,17,147,170,216,220,218},{153,111,171,54,3,93,184},{89,214,249,6,244,40,183},{243,12,170,18,62,190,168},{158,73,146,210,13,15,176},{199,117,185,96,61,240,217},{30,138,173,194,164,0,215}}},
		{{{51,201,200,110,54,197,225},{147,75,152,40,113,22,148},{23,129,19,184,195,125,186},{246,168,204,10,47,206,245},{185,110,135,184,35,159,35},{98,81,143,114,245,52,166},{59,154,99,176,113,16,215}}},
		{{{23,12,189,61,209,252,162},{53,97,215,206,141,93,137},{135,214,214,190,238,231,145},{27,227,36,91,193,122,182},{232,29,149,131,69,50,15},{45,145,117,201,27,88,242},{99,50,242,140,200,222,56}}},
		{{{72,94,46,123,153,52,249},{124,211,220,107,238,11,129},{46,107,166,118,120,50,114},{206,45,245,99,37,43,239},{232,252,233,165,144,92,214},{96,65,184,10,230,41,227},{64,216,5,211,206,48,247}}}
	}};
	double mur = 214;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {131,253,0};
	assert( check(test+" Test 44", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{246,4,189,206,247,146,162},{125,109,159,6,112,147,197},{48,41,246,216,37,63,138},{166,249,54,61,201,165,138},{139,244,24,41,81,124,220},{42,114,251,79,16,151,152},{112,219,131,225,172,137,174}}},
		{{{12,185,218,157,60,34,63},{247,227,195,23,170,39,222},{71,226,13,66,208,215,143},{32,165,216,55,110,218,151},{213,55,56,39,248,114,5},{103,146,1,98,135,117,163},{104,41,211,30,52,237,225}}},
		{{{245,48,123,96,221,101,25},{205,37,97,230,162,206,198},{87,206,54,12,0,244,233},{181,231,198,154,40,106,65},{249,170,3,239,57,91,175},{153,70,32,180,14,147,77},{204,26,74,105,84,108,116}}},
		{{{152,163,254,249,192,114,100},{202,165,155,221,103,164,170},{232,29,176,166,27,65,48},{216,218,5,145,74,120,56},{159,25,126,60,144,179,230},{17,154,138,201,38,79,193},{62,17,178,58,45,51,58}}},
		{{{3,188,88,81,44,41,39},{110,156,101,54,49,127,174},{37,37,70,213,24,175,48},{244,53,80,129,48,49,131},{128,50,204,80,171,211,150},{236,111,73,47,170,117,197},{140,41,169,87,85,6,73}}},
		{{{101,90,219,12,0,151,165},{230,48,222,16,191,93,120},{78,46,160,156,69,30,208},{83,210,220,15,236,165,168},{33,16,6,134,188,174,214},{133,109,223,225,188,252,135},{111,139,53,221,132,199,56}}},
		{{{59,183,21,121,223,4,44},{2,11,156,88,51,49,140},{27,181,244,18,39,125,132},{227,40,171,206,167,177,53},{139,154,194,55,144,178,62},{79,187,81,36,171,40,31},{233,2,152,126,244,251,218}}}
	}};
	double mur = 168;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 45", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{163,10,198,62,128,104,153},{113,153,178,26,156,38,220},{183,77,230,200,74,147,228},{163,21,214,17,45,68,53},{104,149,194,190,108,32,200},{192,94,62,248,223,12,227},{134,49,131,191,230,110,132}}},
		{{{34,15,204,54,134,121,182},{170,184,154,100,220,163,64},{67,198,159,195,124,235,104},{72,179,84,105,167,214,149},{215,3,171,67,43,206,104},{82,27,85,143,149,251,42},{74,136,242,83,217,254,67}}},
		{{{98,28,88,95,111,95,210},{84,119,236,202,161,76,227},{214,14,224,92,185,139,216},{74,248,250,18,85,198,249},{28,54,101,14,162,101,130},{79,219,103,128,167,228,36},{39,203,99,117,145,162,144}}},
		{{{82,11,82,93,89,22,232},{235,234,26,52,152,216,152},{125,33,132,143,146,55,205},{202,26,195,117,100,177,81},{21,21,38,230,28,247,240},{21,221,160,126,213,45,65},{35,250,201,219,192,2,58}}},
		{{{2,37,195,161,196,82,92},{94,247,191,178,212,184,40},{122,254,86,112,90,138,93},{63,91,205,133,174,24,170},{177,140,205,159,39,37,40},{129,194,185,174,17,61,60},{220,227,53,235,232,235,21}}},
		{{{12,119,200,144,193,171,92},{162,79,9,55,21,233,222},{36,152,194,86,75,146,115},{166,87,238,214,130,7,11},{82,124,244,244,147,71,66},{51,45,253,60,19,53,198},{182,250,59,233,76,46,33}}},
		{{{57,146,8,15,91,130,244},{216,197,156,190,186,4,181},{103,98,127,92,55,54,67},{43,135,38,249,147,217,186},{105,232,92,205,200,55,25},{181,89,151,63,131,69,30},{240,91,178,247,224,178,115}}}
	}};
	double mur = 178;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 46", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{207,25,235,85,183,158,219},{153,247,139,232,58,74,123},{82,107,55,142,208,83,26},{44,170,202,119,16,105,58},{63,185,31,84,110,86,176},{230,65,197,141,231,12,72},{88,62,149,40,212,16,232}}},
		{{{27,161,169,138,37,65,227},{51,192,45,150,212,95,91},{190,50,145,239,69,180,212},{32,237,206,241,251,30,194},{138,46,159,221,252,150,227},{207,116,80,64,233,206,229},{53,61,82,31,165,213,134}}},
		{{{72,61,135,71,71,33,176},{120,146,203,254,223,205,182},{235,41,196,27,75,10,175},{228,225,89,65,86,103,107},{84,139,102,66,170,53,227},{245,96,238,98,254,170,208},{237,178,203,46,82,12,7}}},
		{{{103,152,246,179,77,212,132},{48,80,107,54,227,169,177},{102,57,176,192,143,231,13},{235,64,247,6,134,37,161},{67,129,89,79,223,86,154},{62,132,131,82,158,227,128},{38,213,157,243,118,70,235}}},
		{{{249,129,135,133,202,140,102},{188,149,219,0,149,29,141},{193,9,101,27,93,108,250},{16,211,78,163,228,36,242},{201,121,31,96,38,193,194},{133,5,195,91,192,202,248},{211,235,238,60,60,105,58}}},
		{{{99,16,243,47,208,198,87},{51,152,140,67,44,176,207},{133,154,8,161,148,111,27},{128,144,230,119,161,165,198},{184,220,74,244,4,57,119},{188,151,215,145,246,181,152},{195,231,195,22,28,25,104}}},
		{{{216,17,124,141,87,220,86},{178,70,4,99,53,250,92},{16,211,135,254,164,106,129},{123,206,192,70,48,115,147},{217,241,55,45,61,11,0},{88,31,249,144,167,79,44},{155,213,160,173,218,4,56}}}
	}};
	double mur = 59;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 47", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{144,36,232,62,122,152,125},{65,65,159,188,129,183,89},{252,236,194,105,200,15,31},{151,199,50,111,133,203,160},{217,17,234,113,147,136,65},{1,195,157,155,147,224,183},{49,71,189,33,176,231,139}}},
		{{{120,36,220,199,31,37,69},{27,13,165,52,248,132,170},{38,0,193,196,177,188,92},{11,95,197,171,123,176,82},{101,32,116,118,25,72,75},{153,26,189,172,79,110,42},{43,143,65,28,128,41,167}}},
		{{{105,8,55,20,173,24,31},{110,177,4,208,100,253,153},{58,182,127,154,184,184,128},{160,94,65,119,8,201,128},{160,77,202,96,52,125,108},{15,124,83,10,163,239,212},{224,55,245,175,216,65,171}}},
		{{{37,139,152,25,165,170,132},{95,142,156,180,68,85,40},{133,234,93,201,198,23,72},{100,118,213,128,59,9,138},{38,73,37,95,93,185,187},{194,148,150,45,226,52,167},{125,24,177,137,2,235,184}}},
		{{{132,75,204,64,31,25,119},{231,116,201,1,206,220,193},{78,145,150,94,185,213,72},{254,49,204,248,12,246,200},{181,3,206,45,63,85,224},{113,140,37,59,130,205,83},{248,37,131,62,242,109,12}}},
		{{{56,194,235,51,248,212,198},{186,167,43,131,235,61,30},{186,224,107,202,139,34,141},{63,199,114,61,193,87,225},{252,59,48,83,213,38,140},{95,202,251,229,251,64,147},{34,79,117,201,222,25,84}}},
		{{{177,156,227,207,230,101,191},{53,13,197,222,81,22,168},{46,78,92,246,90,191,30},{128,27,146,158,55,125,200},{149,227,84,54,199,13,225},{42,64,41,141,100,70,82},{188,41,244,191,1,213,222}}}
	}};
	double mur = 182;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 48", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{158,179,242,232,103,100,96},{205,243,21,17,105,62,151},{6,167,229,195,253,57,198},{244,201,54,114,44,249,108},{197,54,78,99,68,42,56},{44,112,173,19,0,18,227},{139,36,112,157,73,241,58}}},
		{{{182,254,137,55,172,243,238},{1,73,52,154,179,161,71},{137,173,8,143,47,186,112},{249,185,28,201,100,69,2},{194,246,98,86,48,111,50},{254,79,11,88,223,143,233},{131,133,174,74,83,64,129}}},
		{{{12,151,246,158,24,215,95},{92,203,116,229,142,195,183},{29,120,168,156,24,100,165},{91,120,212,33,228,27,219},{85,203,110,129,171,174,90},{52,168,84,12,159,47,202},{21,62,82,196,5,3,196}}},
		{{{162,173,178,220,101,129,128},{234,46,78,235,119,249,214},{74,70,206,225,211,24,237},{127,112,120,145,248,13,221},{90,0,177,72,251,126,104},{53,155,234,17,250,194,81},{246,51,65,217,115,216,3}}},
		{{{44,190,42,11,60,157,230},{4,166,163,206,164,249,95},{186,92,75,223,147,20,209},{149,224,5,142,195,90,88},{1,64,159,3,173,115,186},{43,140,249,29,193,156,214},{166,96,161,67,8,144,242}}},
		{{{211,65,125,119,187,218,69},{220,22,153,243,121,165,49},{193,213,61,102,42,24,177},{67,175,32,198,141,145,98},{109,163,11,234,121,47,64},{114,51,30,21,92,171,19},{117,25,102,113,133,85,193}}},
		{{{107,43,21,13,102,122,244},{55,254,72,106,132,167,31},{54,253,13,78,123,130,230},{240,155,93,200,172,53,179},{173,43,138,44,94,175,42},{219,84,244,149,2,200,88},{254,218,248,186,132,127,145}}}
	}};
	double mur = 244;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 49", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{66,97,128,34,217,251,134},{187,50,215,69,93,209,212},{131,243,60,131,155,3,248},{195,168,104,76,28,224,200},{173,244,105,217,87,106,88},{163,74,36,20,11,177,48},{91,132,70,103,84,142,199}}},
		{{{163,174,135,64,140,43,107},{193,91,215,253,187,149,178},{32,182,160,1,123,152,202},{85,164,137,92,95,190,239},{188,67,245,199,117,198,15},{22,123,211,203,56,216,16},{146,198,1,21,17,98,186}}},
		{{{76,231,44,194,113,27,25},{176,85,229,89,102,233,144},{174,124,91,253,145,180,214},{117,108,18,21,235,11,92},{168,118,149,138,44,6,117},{108,58,173,135,194,118,74},{53,37,104,229,170,84,142}}},
		{{{83,192,138,126,67,46,27},{40,223,161,107,108,230,74},{249,146,169,129,162,229,165},{114,12,87,126,245,205,21},{8,117,104,47,166,19,143},{23,238,208,132,63,213,21},{85,252,157,99,84,110,38}}},
		{{{243,92,147,19,224,57,245},{201,43,53,183,80,13,249},{156,131,184,201,144,89,138},{6,152,130,182,102,137,174},{89,70,241,24,76,211,233},{231,51,190,72,132,234,126},{253,194,96,75,57,114,70}}},
		{{{75,152,20,126,167,103,223},{135,105,63,212,241,252,68},{148,156,91,58,54,89,91},{66,37,245,229,195,231,41},{241,52,52,246,221,126,13},{114,30,248,236,88,173,88},{39,40,13,246,230,177,53}}},
		{{{140,217,242,138,17,170,92},{65,163,240,200,127,16,90},{62,95,223,101,86,95,102},{87,61,215,94,181,13,17},{77,14,146,247,2,245,234},{168,247,80,83,71,3,154},{155,219,220,161,36,44,79}}}
	}};
	double mur = 115;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 50", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{63,77,192,59,100,186,219},{83,54,222,232,49,56,231},{46,167,170,25,77,72,51},{190,239,189,222,224,130,122},{155,24,14,69,158,241,158},{80,161,78,74,101,195,164},{40,200,218,59,165,162,214}}},
		{{{211,18,194,43,221,138,130},{30,186,206,249,209,46,153},{95,171,239,7,91,73,214},{96,246,25,214,168,64,89},{195,170,31,53,182,222,83},{31,21,14,25,74,244,30},{98,81,64,235,106,65,223}}},
		{{{102,152,99,104,173,160,134},{3,210,166,49,81,235,76},{27,188,161,79,44,168,69},{5,21,83,155,181,158,143},{130,50,17,51,176,167,175},{236,38,173,230,113,43,69},{62,125,219,72,90,97,59}}},
		{{{67,93,9,47,84,43,247},{4,29,38,181,132,162,253},{169,227,145,98,221,76,160},{161,95,4,140,56,150,127},{48,59,250,11,87,212,207},{215,74,156,211,222,92,32},{1,175,187,152,86,238,1}}},
		{{{126,59,251,248,195,89,124},{41,50,10,208,98,253,27},{74,60,113,252,49,201,120},{215,147,128,206,203,72,123},{85,70,105,220,20,25,201},{16,173,215,215,170,223,86},{176,224,102,71,140,239,70}}},
		{{{157,79,127,81,27,75,141},{17,182,249,210,17,228,131},{22,65,37,94,213,4,30},{202,163,132,59,84,106,145},{88,26,105,166,171,226,57},{231,78,207,75,147,242,173},{166,10,159,235,41,78,20}}},
		{{{176,115,54,109,104,64,179},{203,77,61,20,224,127,43},{199,23,90,100,81,166,49},{234,153,24,38,193,68,56},{245,14,126,240,172,197,57},{90,138,57,97,225,129,121},{44,10,90,83,224,103,8}}}
	}};
	double mur = 117;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 51", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{32,80,169,196,153,240,36},{59,134,37,97,110,233,158},{118,102,222,20,127,62,249},{21,40,194,28,173,55,202},{105,25,200,121,21,75,78},{181,116,87,239,174,136,248},{183,137,231,121,115,13,7}}},
		{{{77,142,177,206,131,207,41},{42,243,107,182,217,215,133},{173,113,213,192,168,225,99},{138,0,153,8,128,177,16},{118,19,238,105,34,136,66},{213,81,69,28,173,158,195},{51,30,38,79,159,67,138}}},
		{{{9,121,121,111,46,233,181},{114,41,236,188,218,65,230},{112,133,29,231,70,216,231},{237,184,50,231,134,49,6},{157,83,127,41,109,191,246},{219,100,162,186,207,224,170},{194,29,180,98,232,176,43}}},
		{{{83,134,166,65,91,220,200},{187,73,125,46,199,166,202},{252,241,95,31,69,230,64},{103,198,159,200,228,162,2},{22,219,67,175,60,219,147},{154,254,159,69,225,113,206},{140,112,90,183,17,46,168}}},
		{{{131,247,14,93,146,187,49},{113,201,199,179,56,143,201},{239,0,155,127,165,186,31},{179,245,171,159,101,135,4},{227,216,124,213,80,207,70},{191,176,227,100,45,43,69},{146,232,115,44,29,44,140}}},
		{{{244,22,94,179,17,203,243},{117,61,2,102,47,100,181},{45,21,98,82,190,23,111},{112,144,15,222,26,171,139},{117,31,204,2,183,103,97},{157,101,17,21,252,46,147},{25,205,243,182,158,143,160}}},
		{{{145,199,195,13,105,252,16},{49,193,50,45,245,53,38},{253,198,190,187,22,231,49},{21,147,13,13,174,91,18},{3,215,82,157,242,93,14},{195,146,80,206,57,143,191},{36,254,33,18,208,151,122}}}
	}};
	double mur = 89;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 52", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{67,110,150,111,202,45,51},{185,6,155,32,82,2,11},{63,73,73,224,247,163,184},{238,92,146,75,104,175,197},{80,63,43,205,167,7,237},{147,59,149,36,169,138,33},{126,59,103,222,65,129,105}}},
		{{{90,87,51,74,1,141,97},{147,159,43,53,160,23,86},{237,172,184,171,240,134,221},{9,124,237,56,108,241,227},{164,99,81,141,189,44,123},{219,241,79,47,207,229,191},{131,195,35,208,212,121,72}}},
		{{{66,207,206,221,79,98,238},{165,68,184,49,193,104,244},{140,70,200,32,204,204,176},{78,188,199,178,21,46,158},{80,7,233,164,65,14,170},{69,19,59,65,226,4,61},{226,178,36,146,251,79,200}}},
		{{{46,246,150,4,21,67,192},{166,1,179,196,9,25,59},{51,165,175,88,202,131,130},{0,99,224,152,110,225,131},{16,16,67,229,58,92,101},{248,146,142,108,26,12,74},{1,52,17,6,230,115,158}}},
		{{{20,2,154,70,120,15,125},{142,110,160,120,29,56,195},{77,5,84,187,204,104,188},{9,55,219,240,179,137,12},{82,202,200,189,235,253,150},{53,234,182,204,245,82,142},{2,35,168,205,238,177,27}}},
		{{{157,6,178,34,71,130,77},{151,69,156,106,12,32,35},{176,178,69,142,176,104,114},{202,31,67,68,177,50,252},{129,182,161,176,66,153,19},{228,25,198,5,179,192,111},{91,102,53,50,13,4,121}}},
		{{{129,184,56,171,40,90,59},{167,63,53,202,113,65,86},{86,212,183,120,169,137,157},{157,174,148,188,70,244,113},{141,30,24,235,190,186,61},{177,187,246,154,203,191,50},{136,11,90,154,53,157,235}}}
	}};
	double mur = 170;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 53", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{36,124,147,128,62,248,240},{209,38,113,68,106,42,202},{206,239,75,136,232,104,175},{81,147,74,144,87,237,156},{28,60,39,86,89,26,154},{186,92,81,224,114,216,203},{118,199,174,20,7,63,161}}},
		{{{70,87,41,14,200,120,107},{66,186,226,24,38,138,75},{107,106,93,221,156,183,37},{97,72,54,229,69,128,211},{11,53,12,100,70,3,235},{110,119,99,115,226,85,244},{174,0,1,94,106,178,127}}},
		{{{88,232,175,245,73,45,166},{77,170,67,80,222,17,88},{135,31,213,100,195,33,178},{192,138,219,71,102,133,162},{95,132,107,241,36,21,131},{87,103,183,66,170,100,12},{62,230,191,66,130,187,205}}},
		{{{200,213,205,81,97,211,22},{131,126,155,180,57,156,222},{127,178,109,233,135,228,159},{165,29,235,180,198,173,152},{239,106,4,217,124,75,193},{88,203,177,230,43,122,5},{155,172,28,30,244,72,154}}},
		{{{170,193,156,13,200,229,211},{234,191,191,187,199,149,112},{45,178,4,176,18,6,84},{133,188,5,62,47,147,149},{85,2,135,207,178,176,73},{193,5,236,182,49,28,99},{188,164,163,186,38,138,156}}},
		{{{165,95,187,212,111,170,8},{90,124,118,36,87,180,50},{136,254,9,9,232,42,193},{17,195,3,102,110,243,108},{239,126,195,15,61,99,161},{237,34,140,65,175,137,25},{240,124,121,234,206,107,187}}},
		{{{236,85,41,94,226,188,198},{240,251,180,223,178,96,254},{217,179,46,125,62,79,122},{114,86,55,122,158,3,211},{198,246,250,16,213,178,97},{175,63,132,104,53,126,169},{179,78,224,212,19,251,139}}}
	}};
	double mur = 57;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 54", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{39,134,119,38,175,242,115},{33,153,52,226,201,208,58},{148,77,34,110,93,242,240},{26,108,222,111,183,63,215},{89,25,163,183,153,99,156},{111,153,34,155,205,2,42},{179,177,26,249,68,49,245}}},
		{{{17,217,6,194,20,224,53},{91,77,94,166,76,84,78},{62,17,146,235,31,119,47},{118,242,55,44,195,126,194},{98,147,6,71,88,214,251},{26,133,46,240,65,91,136},{162,239,25,137,190,30,180}}},
		{{{56,61,105,219,65,227,142},{23,225,157,100,22,68,66},{152,178,142,200,103,33,219},{163,43,30,83,183,6,122},{15,42,151,183,189,132,42},{208,219,251,103,117,99,172},{39,164,41,33,103,63,79}}},
		{{{123,30,85,116,82,79,156},{220,19,117,237,79,96,135},{192,180,65,156,153,173,176},{13,200,19,18,113,156,88},{188,84,116,75,36,85,74},{114,104,48,236,6,244,69},{65,32,240,145,57,59,184}}},
		{{{187,101,76,86,119,214,104},{131,19,253,4,241,53,133},{155,15,61,120,197,115,187},{91,23,214,80,8,224,206},{237,203,139,130,62,122,176},{171,86,211,88,89,233,243},{90,142,213,104,29,49,180}}},
		{{{207,249,1,8,206,212,213},{84,114,202,8,204,5,73},{132,180,87,206,49,131,248},{227,185,230,89,95,36,141},{247,85,193,74,70,80,141},{96,19,228,252,216,86,96},{53,129,189,102,43,183,175}}},
		{{{117,204,98,188,107,254,143},{32,246,228,121,196,180,236},{252,81,49,235,126,141,59},{117,107,69,70,159,156,88},{223,32,243,64,218,154,242},{160,202,166,17,254,207,124},{54,207,78,209,186,192,9}}}
	}};
	double mur = 123;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 55", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{132,231,109,13,103,139,134},{66,209,52,44,66,48,234},{141,177,156,25,120,15,112},{207,111,183,234,89,203,240},{127,10,202,172,46,253,162},{234,203,168,157,172,181,218},{141,134,170,105,226,22,95}}},
		{{{89,80,74,131,76,193,250},{71,182,188,13,83,102,155},{243,88,203,14,183,138,226},{20,105,23,78,195,160,32},{46,127,174,213,146,96,184},{105,165,233,88,31,0,179},{56,72,165,8,196,45,100}}},
		{{{212,220,74,42,184,87,48},{16,105,16,99,18,15,144},{165,136,172,123,132,95,185},{141,7,197,179,83,52,95},{115,185,119,223,24,103,203},{161,153,84,174,53,181,236},{181,64,173,215,243,91,184}}},
		{{{159,246,75,32,101,191,156},{67,93,121,99,124,167,12},{253,34,150,244,54,195,129},{122,173,245,25,197,133,198},{129,240,155,12,196,36,134},{138,250,120,161,131,61,188},{162,164,128,143,245,19,28}}},
		{{{24,1,191,78,95,251,247},{29,149,32,24,8,37,124},{120,108,175,27,32,178,171},{185,99,79,162,100,123,122},{102,76,59,72,100,160,48},{129,149,88,184,57,212,30},{110,197,100,209,117,117,33}}},
		{{{28,181,227,150,189,128,191},{33,205,232,77,202,247,160},{169,121,172,111,81,187,223},{210,41,225,251,109,219,106},{123,140,9,147,88,11,42},{43,191,90,68,100,39,31},{252,125,63,225,21,81,233}}},
		{{{70,99,74,146,226,63,75},{162,3,7,10,244,64,102},{229,177,237,106,95,189,74},{203,136,123,8,109,1,218},{106,250,64,172,54,140,137},{100,68,103,203,64,254,34},{89,98,33,67,219,91,47}}}
	}};
	double mur = 7;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 56", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{26,237,144,182,159,157,144},{148,133,189,34,196,227,224},{81,187,60,230,38,6,90},{84,113,169,20,38,239,121},{228,147,243,47,192,231,36},{86,117,171,48,239,232,245},{244,128,128,194,154,154,25}}},
		{{{56,97,31,94,151,186,211},{16,81,165,14,112,229,248},{211,71,187,53,40,13,250},{44,164,145,94,64,173,99},{133,122,184,95,132,169,212},{236,244,204,251,56,97,205},{246,45,224,220,122,219,50}}},
		{{{127,53,3,250,189,160,157},{187,3,45,109,87,73,141},{201,219,141,202,68,112,148},{110,52,211,54,37,205,105},{66,113,122,120,171,230,87},{78,254,99,26,197,159,132},{94,188,253,95,5,234,13}}},
		{{{19,99,29,230,204,21,192},{239,40,125,126,131,30,160},{53,80,223,179,239,214,168},{211,172,162,151,81,213,73},{122,90,228,150,230,251,100},{236,226,55,198,77,26,197},{59,68,143,206,41,230,118}}},
		{{{136,68,200,250,177,58,164},{176,148,189,6,35,105,112},{207,132,121,171,132,13,20},{64,153,227,109,163,127,82},{86,189,244,111,199,94,140},{251,134,10,58,233,97,194},{76,43,174,53,168,206,51}}},
		{{{55,126,44,5,250,39,187},{102,237,118,111,101,99,113},{223,170,38,47,94,163,131},{242,84,70,26,168,74,145},{175,38,206,38,40,240,198},{254,170,227,209,86,156,30},{132,245,7,27,93,157,117}}},
		{{{205,32,182,54,175,172,214},{28,45,218,204,77,28,137},{30,220,225,222,186,235,114},{215,86,199,237,71,170,111},{206,169,12,177,91,104,169},{163,3,206,231,121,150,216},{102,228,8,249,88,173,40}}}
	}};
	double mur = 164;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 57", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{5,185,16,139,88,159,252},{222,97,136,88,118,106,213},{248,181,56,26,75,163,73},{184,43,214,93,226,101,218},{162,225,142,151,27,69,67},{154,162,122,163,61,171,188},{27,86,217,178,156,114,146}}},
		{{{220,29,235,230,100,146,46},{233,111,126,231,181,205,19},{65,6,181,253,149,254,13},{159,229,14,245,155,192,213},{220,31,164,10,134,197,217},{144,52,163,10,1,66,60},{252,159,230,100,12,245,1}}},
		{{{221,72,228,14,74,194,81},{159,196,117,198,150,170,217},{78,219,5,32,39,224,10},{175,94,217,74,18,235,7},{207,231,134,87,174,16,6},{219,29,133,106,200,58,226},{213,51,164,183,93,103,160}}},
		{{{158,17,20,58,24,59,134},{228,83,251,46,211,29,70},{174,76,214,168,120,84,205},{103,192,89,97,124,96,75},{207,102,55,28,64,125,34},{157,196,244,214,31,168,197},{120,229,166,162,150,141,184}}},
		{{{189,203,28,111,168,3,232},{92,251,61,156,81,237,213},{152,24,100,93,67,192,19},{188,223,127,46,141,107,21},{156,8,0,231,22,193,199},{254,35,101,221,27,65,3},{92,142,73,213,147,45,166}}},
		{{{128,1,18,57,198,187,175},{168,186,62,133,62,180,225},{58,30,64,218,37,190,123},{208,27,214,55,21,125,83},{88,34,181,162,30,20,72},{181,139,194,45,44,26,195},{216,251,181,216,202,226,91}}},
		{{{114,180,192,162,192,174,231},{10,225,85,193,42,55,204},{212,20,148,202,29,130,152},{228,70,206,236,145,30,74},{156,157,253,119,129,47,36},{55,128,19,99,144,136,146},{52,38,147,140,58,189,54}}}
	}};
	double mur = 195;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,125,0};
	assert( check(test+" Test 58", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{239,20,170,227,141,246,210},{103,250,120,181,113,86,221},{35,72,144,156,77,0,106},{204,2,162,22,127,202,52},{100,164,12,121,200,188,206},{23,195,22,251,102,120,56},{5,42,217,24,82,38,125}}},
		{{{218,61,240,254,224,190,18},{149,253,28,246,18,23,240},{214,42,112,220,162,156,73},{109,201,111,154,62,112,152},{220,125,157,202,177,187,101},{177,226,240,214,8,183,244},{244,119,17,97,167,141,19}}},
		{{{147,28,143,55,198,190,185},{81,177,15,115,9,211,37},{29,227,20,180,183,210,217},{74,194,153,23,184,185,166},{242,224,62,82,133,23,29},{193,55,194,198,161,249,123},{33,237,153,18,129,244,95}}},
		{{{22,86,56,234,27,55,43},{97,199,201,52,42,64,84},{55,229,25,98,66,122,228},{65,70,97,122,73,148,252},{8,103,26,236,77,208,23},{80,75,114,16,228,131,153},{16,231,213,172,224,58,243}}},
		{{{37,248,81,155,38,75,2},{171,23,144,251,128,61,162},{184,68,167,217,209,78,91},{161,77,164,245,122,104,176},{128,178,231,162,235,251,12},{197,241,52,23,85,124,118},{102,138,220,191,230,149,220}}},
		{{{77,64,172,124,7,121,146},{42,152,208,155,219,91,202},{197,35,198,63,38,149,24},{66,145,222,240,54,48,189},{140,96,194,198,83,127,21},{86,183,171,92,202,209,8},{54,30,82,251,115,52,151}}},
		{{{231,145,245,159,163,211,92},{9,163,146,216,143,93,83},{49,59,19,97,251,7,111},{72,172,210,233,15,98,46},{125,59,239,101,204,118,57},{252,92,3,10,219,86,95},{72,120,47,203,218,123,205}}}
	}};
	double mur = 77;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,107,1};
	assert( check(test+" Test 59", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{100,22,221,73,156,75,193},{242,193,246,61,110,188,151},{149,193,134,147,182,9,15},{209,49,88,44,246,75,128},{97,252,34,30,167,139,224},{23,78,167,144,180,33,226},{37,141,114,91,40,131,238}}},
		{{{38,131,75,181,94,167,233},{166,249,190,132,175,154,98},{96,10,87,48,115,6,31},{188,130,244,230,127,234,197},{203,34,144,207,110,138,91},{158,166,194,92,118,200,90},{225,223,85,24,157,251,147}}},
		{{{157,195,229,169,204,144,246},{13,116,223,142,246,136,181},{169,18,78,242,202,1,198},{200,254,216,227,54,77,36},{2,237,57,236,0,152,120},{193,38,54,181,31,106,23},{153,215,100,83,69,110,91}}},
		{{{241,24,144,49,182,15,240},{239,108,13,165,64,239,151},{42,146,201,28,141,86,49},{209,110,29,55,109,69,68},{157,51,244,7,249,236,91},{168,66,248,182,205,4,134},{24,190,98,106,181,55,212}}},
		{{{66,173,164,26,226,94,163},{131,24,126,249,232,31,62},{61,68,120,193,241,112,192},{7,105,69,143,81,101,45},{126,34,131,95,191,190,153},{109,174,83,29,53,224,115},{20,49,254,234,180,224,211}}},
		{{{6,184,250,93,149,193,148},{117,135,138,219,118,88,3},{111,243,221,248,23,48,120},{15,218,196,203,44,243,12},{116,164,95,57,95,119,213},{116,24,65,49,148,201,130},{224,163,149,28,80,208,187}}},
		{{{85,142,220,108,208,167,35},{150,199,133,54,151,60,109},{36,69,23,136,135,249,207},{138,50,124,49,172,128,136},{180,125,248,38,236,129,97},{142,84,243,222,246,170,57},{195,137,59,101,103,102,190}}}
	}};
	double mur = 230;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 60", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{175,91,18,250,54,239,138},{130,175,104,73,57,0,254},{229,76,72,233,16,206,44},{237,184,235,212,28,145,189},{219,175,59,108,205,2,120},{116,198,74,245,251,174,229},{131,200,198,236,200,75,160}}},
		{{{152,197,125,226,83,65,159},{91,123,122,224,104,94,2},{0,212,96,101,204,69,240},{92,60,178,99,10,113,116},{196,39,54,185,57,130,233},{55,183,44,143,250,11,205},{216,9,6,185,214,19,207}}},
		{{{189,129,43,115,120,12,6},{141,64,223,213,216,216,208},{158,55,223,145,241,243,60},{120,34,237,41,146,88,71},{88,22,144,161,167,193,120},{254,79,59,221,54,166,140},{249,114,7,180,240,122,246}}},
		{{{173,108,243,171,214,157,65},{217,111,38,217,60,220,201},{254,143,42,52,5,71,154},{92,92,251,238,137,6,37},{84,148,150,127,37,11,123},{50,238,77,17,240,109,177},{55,205,191,48,17,23,71}}},
		{{{191,138,239,43,6,203,75},{198,51,200,188,131,89,163},{116,118,27,14,181,63,83},{186,135,84,70,181,173,101},{182,179,77,111,235,254,199},{225,228,175,3,12,227,16},{43,139,71,166,92,65,249}}},
		{{{240,18,14,89,43,95,52},{22,64,110,100,43,178,208},{47,208,129,240,234,57,159},{241,20,42,246,0,83,151},{61,107,142,133,49,7,170},{0,31,46,101,88,1,219},{104,51,229,215,113,38,168}}},
		{{{202,168,186,142,34,132,177},{139,9,157,61,212,209,155},{248,137,222,212,131,138,194},{75,199,55,24,184,59,108},{15,195,27,37,199,112,153},{189,118,227,158,123,109,128},{239,180,65,217,141,236,247}}}
	}};
	double mur = 241;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 61", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{235,161,0,6,187,49,150},{217,35,96,190,234,74,33},{10,225,195,149,97,232,6},{182,28,242,66,212,77,204},{216,162,80,40,195,144,49},{112,250,1,46,77,168,225},{70,161,123,173,129,253,191}}},
		{{{170,120,47,23,83,116,211},{187,20,220,76,153,85,70},{70,171,29,177,126,197,160},{29,113,39,37,232,67,41},{38,187,232,60,231,221,108},{208,80,32,105,67,194,202},{43,223,130,130,180,124,13}}},
		{{{186,160,228,39,189,128,222},{230,196,17,27,41,207,131},{113,155,237,150,98,117,25},{25,153,230,140,47,150,183},{9,26,201,43,142,173,188},{215,17,17,247,88,188,35},{187,130,168,90,95,73,203}}},
		{{{53,193,21,61,126,106,214},{188,107,95,221,197,69,188},{140,9,125,254,212,247,216},{3,134,6,212,0,151,232},{183,76,195,201,219,214,234},{6,39,122,224,115,9,37},{0,153,224,141,4,246,183}}},
		{{{212,195,187,146,31,46,85},{11,239,197,152,163,1,137},{133,222,206,251,12,205,145},{59,79,167,99,148,210,117},{85,117,40,195,176,63,228},{132,250,135,9,65,111,183},{212,195,9,254,9,210,183}}},
		{{{71,1,251,240,117,239,154},{91,199,243,159,14,169,192},{85,85,158,13,141,62,239},{144,108,224,231,60,81,9},{90,10,87,10,194,54,216},{148,240,44,223,36,59,197},{205,189,165,209,232,207,94}}},
		{{{156,145,231,69,168,125,183},{205,193,71,198,70,181,178},{100,250,181,51,226,43,76},{216,181,7,107,91,98,160},{192,204,129,251,59,61,100},{27,200,3,25,69,230,54},{253,91,228,67,201,79,194}}}
	}};
	double mur = 22;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 62", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{183,173,16,59,63,11,13},{77,19,125,16,5,146,10},{150,199,145,229,127,98,182},{108,167,81,108,143,5,142},{253,104,244,31,61,214,237},{161,254,14,89,22,26,33},{46,149,51,223,221,118,233}}},
		{{{74,59,123,46,38,223,156},{34,5,132,245,179,15,213},{192,33,190,25,201,83,177},{170,34,226,217,21,164,134},{208,34,156,246,2,117,8},{174,47,77,234,178,2,86},{90,134,41,248,34,252,26}}},
		{{{144,194,247,185,105,19,205},{50,104,227,163,55,179,135},{49,5,119,75,231,156,175},{130,206,2,145,231,207,79},{8,198,7,33,208,60,223},{71,37,85,57,215,50,143},{21,219,244,211,111,161,132}}},
		{{{138,1,104,184,98,33,31},{53,223,97,7,149,206,207},{230,202,211,64,176,44,60},{180,175,125,4,83,92,244},{202,130,184,248,126,172,19},{108,123,139,187,175,55,95},{205,31,162,61,157,57,170}}},
		{{{49,237,195,149,37,164,232},{235,88,196,116,173,62,215},{97,211,220,189,116,78,242},{63,24,9,234,228,72,227},{31,169,220,101,97,234,238},{210,48,30,31,237,242,87},{0,249,249,122,32,206,170}}},
		{{{92,72,38,73,43,142,133},{58,215,230,227,29,223,144},{247,184,7,70,190,26,53},{237,201,136,230,114,202,43},{23,182,114,197,171,192,25},{77,214,140,211,227,229,45},{164,198,239,128,249,121,253}}},
		{{{130,104,120,5,35,168,154},{202,156,196,49,91,70,78},{142,102,172,162,138,14,232},{168,142,161,77,116,84,170},{62,253,171,9,7,76,239},{153,222,105,142,15,86,178},{82,39,47,118,64,78,236}}}
	}};
	double mur = 110;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 63", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{85,39,129,204,90,62,209},{75,96,54,187,252,242,165},{16,208,43,4,146,247,206},{88,46,244,77,103,107,184},{65,67,32,217,36,222,180},{20,195,59,242,67,180,122},{220,94,5,179,250,29,98}}},
		{{{171,233,130,206,157,84,215},{78,9,113,114,171,212,180},{240,226,3,133,10,224,107},{148,181,179,5,191,233,141},{3,159,192,137,83,222,168},{1,19,29,70,9,181,6},{71,172,53,152,168,182,63}}},
		{{{97,208,41,211,5,139,77},{177,243,247,112,46,91,9},{249,52,144,150,159,170,112},{189,127,165,117,23,56,163},{119,198,44,99,77,91,211},{237,116,223,51,251,90,118},{215,60,12,221,190,37,110}}},
		{{{181,193,1,22,202,237,203},{107,148,34,234,248,7,141},{199,196,83,171,221,109,102},{125,38,56,47,47,208,167},{58,4,1,13,56,63,41},{167,51,158,34,157,42,102},{159,80,96,5,113,210,229}}},
		{{{60,246,44,55,35,108,6},{228,214,226,10,150,131,155},{222,35,0,196,228,33,222},{140,13,112,72,87,236,227},{196,7,34,248,193,191,247},{48,195,130,103,209,176,66},{94,95,49,69,210,220,188}}},
		{{{148,6,73,172,240,98,49},{62,58,204,29,128,110,186},{126,168,212,9,5,176,175},{14,225,29,127,67,252,239},{167,154,193,89,96,101,37},{75,40,44,40,14,207,105},{37,83,143,21,180,109,38}}},
		{{{235,119,38,39,128,2,105},{88,86,213,172,184,214,78},{35,172,5,220,14,241,147},{156,239,13,230,68,187,167},{80,227,61,192,192,190,32},{64,182,250,118,220,193,214},{90,165,48,31,167,204,169}}}
	}};
	double mur = 102;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 64", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{54,169,222,236,133,238,33},{220,188,173,43,166,248,28},{242,94,90,112,67,246,121},{194,246,139,248,111,248,98},{13,113,89,162,197,122,69},{202,136,21,173,29,183,204},{44,55,56,22,193,11,177}}},
		{{{18,235,206,215,181,188,96},{177,171,53,76,221,116,164},{204,247,57,41,96,193,69},{214,157,192,89,89,203,2},{160,4,144,57,38,152,43},{98,224,163,67,179,185,235},{35,43,170,174,218,191,43}}},
		{{{236,11,116,245,245,192,128},{161,62,76,197,144,254,122},{171,77,51,252,160,182,232},{166,195,224,200,64,165,130},{198,120,43,238,137,59,73},{181,219,101,242,55,120,197},{225,16,110,184,7,185,244}}},
		{{{156,122,242,213,6,157,78},{160,15,247,92,139,90,247},{132,24,42,184,114,248,39},{204,126,77,91,36,160,228},{126,107,254,111,37,39,56},{38,91,131,160,73,211,236},{101,169,219,189,16,125,47}}},
		{{{197,18,135,74,203,100,189},{206,5,48,145,160,113,202},{93,85,31,169,166,151,249},{177,16,254,116,217,66,200},{136,58,73,123,190,67,249},{246,189,14,26,192,172,198},{156,50,208,40,217,242,143}}},
		{{{101,100,251,204,178,246,145},{13,80,14,137,215,123,96},{44,162,214,96,22,93,55},{200,64,146,183,66,46,171},{235,208,25,193,247,108,161},{172,15,200,132,220,247,56},{159,161,55,22,89,51,253}}},
		{{{47,111,22,108,235,171,169},{239,145,181,56,208,51,54},{192,122,194,22,191,126,227},{252,227,193,40,206,34,226},{234,153,205,92,130,143,90},{57,164,67,93,71,230,21},{239,4,29,221,188,174,125}}}
	}};
	double mur = 132;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,159,0};
	assert( check(test+" Test 65", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{134,236,122,168,165,82,239},{51,112,133,105,1,76,192},{175,253,180,189,121,244,202},{215,187,180,133,175,186,127},{12,19,199,120,51,197,125},{56,146,19,173,100,165,126},{129,3,80,46,115,176,222}}},
		{{{238,90,52,86,115,36,187},{44,60,161,57,23,9,108},{171,114,193,81,130,238,139},{7,8,89,115,119,41,245},{118,111,213,89,73,57,96},{33,26,151,158,122,214,170},{26,108,117,195,137,3,56}}},
		{{{243,71,229,134,212,6,66},{228,188,174,238,120,32,85},{126,16,208,218,205,253,212},{141,4,106,159,113,116,92},{216,161,88,178,58,69,103},{73,99,124,1,153,92,238},{180,151,67,38,228,116,29}}},
		{{{180,121,21,8,62,54,112},{102,185,58,112,216,186,103},{153,80,119,43,245,46,18},{21,182,210,225,68,83,243},{254,117,33,46,34,26,213},{56,221,38,207,28,135,131},{16,99,25,188,85,120,109}}},
		{{{140,215,230,214,107,14,234},{75,143,188,145,217,165,99},{10,44,2,203,43,6,71},{240,232,92,26,95,254,79},{103,31,192,226,240,216,208},{184,65,240,46,204,103,28},{23,222,226,5,58,118,12}}},
		{{{210,174,129,90,228,159,207},{106,245,33,178,94,185,180},{134,136,62,152,129,166,89},{190,56,217,108,217,93,59},{62,37,189,120,121,191,31},{240,176,71,143,90,221,158},{53,178,155,46,207,250,37}}},
		{{{108,84,129,62,31,172,16},{6,216,220,223,132,54,88},{183,153,191,171,218,213,115},{142,1,133,152,66,56,23},{146,150,91,37,198,113,43},{94,84,91,197,151,9,72},{83,68,143,92,82,234,189}}}
	}};
	double mur = 10;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 66", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{242,154,219,115,131,206,140},{12,237,225,153,118,166,179},{28,159,66,82,231,160,10},{23,201,164,231,221,1,53},{227,198,141,160,198,129,74},{112,223,51,21,80,176,171},{217,6,4,214,3,61,222}}},
		{{{138,166,130,36,231,168,49},{211,227,41,121,7,189,208},{114,78,41,96,207,126,29},{253,127,231,152,121,137,248},{4,71,129,53,221,123,125},{36,72,71,124,212,19,201},{83,86,164,57,199,198,120}}},
		{{{77,141,199,140,32,173,54},{113,177,47,183,188,178,64},{228,184,221,243,175,156,43},{120,100,15,16,130,56,46},{225,234,67,106,9,208,254},{8,165,135,242,241,43,13},{100,102,45,221,27,93,57}}},
		{{{192,191,163,186,212,122,105},{231,15,229,29,8,111,132},{93,159,150,240,159,117,231},{11,149,169,222,185,131,144},{169,146,230,191,203,119,87},{223,159,218,171,66,106,123},{115,212,138,138,3,178,107}}},
		{{{209,58,56,249,33,196,76},{170,215,89,114,129,183,69},{230,19,175,50,250,214,226},{142,254,236,7,122,222,223},{156,199,178,13,119,131,171},{249,156,4,121,154,16,85},{131,2,129,57,191,7,77}}},
		{{{57,13,39,4,222,244,215},{83,164,34,36,50,80,105},{88,171,68,229,44,180,126},{78,4,189,234,67,246,82},{193,198,183,208,66,15,125},{177,10,134,157,253,199,253},{232,206,218,3,64,196,64}}},
		{{{92,166,166,254,223,148,32},{30,56,30,223,244,49,251},{102,88,230,91,252,94,153},{117,216,170,49,179,9,138},{173,166,93,251,232,152,213},{34,60,46,110,120,251,238},{237,164,177,218,68,200,166}}}
	}};
	double mur = 171;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 67", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{57,6,188,123,247,169,238},{246,88,185,83,93,212,187},{237,6,185,234,140,107,197},{250,227,132,147,96,197,6},{243,141,9,120,177,119,9},{178,208,5,187,29,142,119},{113,221,186,119,0,66,210}}},
		{{{153,235,228,25,12,214,8},{146,52,96,75,45,37,133},{148,64,189,244,86,86,177},{164,98,33,240,99,79,243},{15,101,173,182,94,198,99},{213,247,111,215,174,52,94},{132,245,219,171,101,85,167}}},
		{{{129,227,236,135,133,81,208},{128,197,39,162,223,156,200},{239,252,212,92,139,19,232},{175,143,166,175,221,107,11},{210,81,102,229,184,69,15},{168,202,74,211,208,175,178},{76,122,32,236,168,39,217}}},
		{{{63,14,132,238,22,61,207},{147,204,219,74,89,2,233},{36,30,239,53,230,61,77},{69,175,208,52,2,48,99},{118,207,161,37,42,74,7},{3,212,121,91,132,210,246},{235,174,53,141,248,151,153}}},
		{{{69,215,110,13,230,190,82},{70,74,220,203,32,8,136},{113,3,84,198,159,166,243},{26,23,248,49,144,23,22},{102,166,90,254,42,137,6},{179,214,7,15,241,73,17},{124,102,75,144,62,36,62}}},
		{{{236,221,228,126,205,22,249},{119,234,94,19,177,50,213},{241,126,13,166,208,88,2},{73,226,27,179,153,113,101},{59,246,164,213,128,28,174},{76,184,216,84,219,117,195},{63,9,40,237,51,147,66}}},
		{{{198,148,150,20,99,33,116},{242,229,68,210,125,56,215},{18,189,237,41,45,218,247},{210,221,201,66,225,10,52},{185,113,116,83,243,105,89},{233,198,76,204,89,228,136},{110,199,55,38,131,193,144}}}
	}};
	double mur = 226;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 68", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{233,243,54,172,141,10,198},{104,174,90,89,236,63,16},{121,188,94,76,66,130,35},{83,222,127,5,212,74,146},{85,1,160,111,29,200,103},{155,135,80,69,188,0,175},{195,210,124,220,83,153,186}}},
		{{{248,198,113,155,157,94,15},{179,215,220,2,66,51,197},{97,29,170,42,113,33,158},{201,211,193,56,165,112,83},{187,234,180,102,227,156,213},{120,125,178,174,53,9,158},{213,105,112,1,1,41,13}}},
		{{{6,43,226,234,143,177,223},{228,2,170,95,14,137,73},{206,75,154,215,49,79,151},{197,137,116,187,171,253,40},{61,99,4,87,27,182,93},{97,118,174,216,142,198,59},{58,72,31,204,78,121,193}}},
		{{{167,140,153,134,47,60,246},{26,234,251,209,16,192,237},{97,91,88,161,239,118,164},{2,241,103,55,77,247,94},{184,59,92,92,98,182,98},{11,238,63,161,247,79,5},{93,250,36,152,76,189,13}}},
		{{{65,240,11,6,135,171,133},{98,247,220,39,132,217,141},{18,224,92,189,125,123,75},{226,14,159,9,2,22,40},{134,249,5,131,0,93,206},{145,60,134,232,126,24,103},{216,52,236,156,235,110,46}}},
		{{{173,119,189,46,65,95,80},{220,218,110,14,218,196,253},{199,156,74,43,98,32,196},{71,124,240,5,203,234,161},{232,128,33,210,242,197,208},{202,50,44,64,200,146,132},{217,223,174,193,166,63,35}}},
		{{{218,252,148,241,46,21,134},{246,91,88,97,195,211,143},{183,66,202,76,114,5,86},{79,150,238,97,203,40,142},{16,102,220,126,53,133,114},{6,221,8,66,106,238,83},{81,124,134,141,133,44,129}}}
	}};
	double mur = 5;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 69", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{19,107,227,138,10,231,211},{8,100,161,47,187,170,219},{231,241,30,194,115,70,178},{188,114,173,89,26,240,76},{58,200,34,248,145,152,161},{119,173,50,208,134,28,38},{35,32,97,210,49,148,198}}},
		{{{115,243,52,227,196,175,131},{150,84,81,5,171,153,83},{185,196,140,163,54,120,242},{235,149,229,36,39,45,131},{34,13,86,225,121,97,217},{75,143,240,50,239,248,114},{109,13,19,89,126,13,42}}},
		{{{117,3,79,238,174,188,13},{27,72,247,165,95,4,17},{243,159,99,86,111,33,160},{237,136,64,79,76,246,215},{215,104,10,39,145,208,88},{70,222,126,243,61,91,25},{197,180,245,220,178,43,1}}},
		{{{136,206,63,16,107,146,233},{118,4,212,2,28,163,47},{236,144,169,210,196,28,197},{161,66,10,135,107,151,238},{221,123,140,58,45,71,210},{248,227,84,117,24,85,222},{43,103,180,229,45,166,53}}},
		{{{22,68,192,139,100,126,33},{12,145,153,197,171,177,211},{26,77,39,170,51,167,214},{119,88,62,36,133,26,13},{246,224,182,229,237,229,85},{224,69,9,63,114,164,22},{106,150,185,8,39,118,165}}},
		{{{228,139,250,47,183,254,176},{113,55,115,37,176,112,120},{90,37,41,203,101,199,53},{81,140,18,159,243,240,103},{170,151,227,250,55,96,62},{117,111,77,4,85,86,241},{183,231,177,156,117,250,254}}},
		{{{40,202,186,41,196,138,128},{61,191,152,179,188,125,55},{222,193,31,127,199,40,201},{227,68,167,182,101,54,178},{118,165,148,92,90,251,232},{43,103,128,7,6,44,222},{70,229,124,157,33,95,244}}}
	}};
	double mur = 84;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 70", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{54,235,66,43,20,148,229},{162,167,69,196,223,61,178},{43,197,106,141,198,94,67},{236,127,206,111,65,159,100},{220,118,234,96,110,102,22},{118,101,162,233,184,86,76},{64,226,132,61,97,155,63}}},
		{{{203,81,214,249,104,214,144},{147,91,189,116,105,250,211},{143,134,159,40,93,189,20},{70,88,240,89,100,95,121},{158,230,47,154,105,118,183},{41,192,14,245,132,20,81},{40,239,147,147,236,104,235}}},
		{{{101,5,51,146,134,203,8},{216,128,85,86,213,171,148},{79,47,27,178,64,175,66},{167,117,90,74,213,114,198},{66,6,94,30,21,213,218},{102,129,243,99,52,160,137},{250,168,123,8,112,121,69}}},
		{{{186,243,167,179,57,44,52},{128,33,174,75,206,132,167},{82,101,166,219,204,242,32},{125,65,219,152,248,66,90},{4,91,108,2,41,47,247},{234,48,243,92,226,161,19},{234,147,71,25,187,77,160}}},
		{{{55,108,27,187,236,77,110},{147,226,136,186,144,81,9},{22,139,240,77,193,241,17},{94,225,175,51,124,248,9},{205,19,125,15,164,203,169},{200,89,200,119,83,75,147},{217,11,229,12,169,12,208}}},
		{{{63,49,115,161,1,207,27},{42,248,98,58,178,143,32},{104,173,170,57,237,189,93},{112,79,198,29,63,53,226},{211,204,19,209,155,54,215},{103,55,69,11,51,238,62},{94,192,66,199,95,251,205}}},
		{{{236,36,244,39,65,115,217},{122,45,176,55,104,96,21},{6,225,102,49,140,139,184},{36,100,2,173,233,88,109},{110,144,179,174,167,197,65},{145,82,82,9,134,148,148},{252,64,90,196,48,141,97}}}
	}};
	double mur = 70;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 71", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{168,136,129,100,188,155,73},{97,142,178,9,188,144,69},{29,18,195,81,101,20,230},{21,141,189,11,215,185,179},{215,72,29,205,180,213,61},{97,117,243,107,87,163,103},{65,165,200,62,51,20,29}}},
		{{{10,90,89,44,230,159,36},{12,162,110,230,102,227,250},{229,118,127,212,158,234,40},{3,125,235,113,161,90,20},{187,147,242,89,155,162,12},{36,161,35,165,51,143,180},{29,51,195,142,194,163,152}}},
		{{{67,247,238,252,73,75,18},{178,155,57,7,101,39,186},{114,26,123,149,67,110,253},{85,25,38,66,73,71,105},{3,42,63,11,127,126,158},{42,130,135,195,117,127,80},{0,207,171,207,247,188,16}}},
		{{{178,168,159,192,151,46,52},{137,23,169,213,225,123,24},{169,251,191,227,173,46,155},{177,180,22,66,137,80,153},{191,139,245,211,16,15,166},{45,4,133,240,203,252,69},{27,85,42,176,218,117,161}}},
		{{{138,131,167,145,199,159,142},{114,173,54,87,74,169,79},{29,116,182,194,251,42,54},{210,100,135,66,127,40,47},{2,137,30,169,146,160,141},{161,203,142,97,254,141,222},{124,113,102,63,182,199,150}}},
		{{{173,169,130,91,213,234,175},{47,48,211,61,11,138,141},{135,22,226,50,47,13,75},{105,146,63,206,246,146,185},{78,110,75,117,212,168,153},{66,247,207,157,184,58,175},{96,177,76,249,103,134,144}}},
		{{{95,87,181,25,174,90,136},{46,145,206,182,253,73,188},{49,1,237,246,92,185,51},{112,61,128,52,42,141,26},{182,181,12,236,74,226,1},{107,192,130,22,234,144,96},{76,229,142,165,56,71,69}}}
	}};
	double mur = 6;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 72", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{59,3,88,150,29,243,225},{176,122,155,141,174,32,206},{213,56,188,250,69,218,168},{124,119,78,201,197,168,53},{19,77,64,104,89,76,188},{44,131,38,22,113,74,193},{111,246,16,172,233,21,39}}},
		{{{141,76,54,218,95,175,156},{19,3,47,156,127,44,102},{92,237,92,152,104,218,133},{154,97,230,31,86,150,64},{48,211,221,53,229,172,113},{135,146,211,81,39,244,161},{23,52,126,199,182,4,109}}},
		{{{40,111,79,98,140,78,28},{126,94,145,0,178,159,250},{199,183,209,16,87,83,75},{20,188,29,85,126,175,182},{208,3,158,243,53,121,197},{107,154,185,162,185,154,23},{205,81,192,254,42,239,243}}},
		{{{234,95,142,216,160,5,38},{165,57,163,103,168,32,96},{150,44,134,214,17,142,189},{247,33,160,178,93,146,138},{245,118,19,53,222,78,170},{229,149,155,48,139,128,202},{21,206,8,197,103,228,69}}},
		{{{53,237,92,237,152,152,206},{117,249,247,157,40,186,198},{18,35,82,218,240,79,225},{123,139,203,1,205,30,131},{251,69,56,249,181,201,136},{168,171,91,14,88,141,7},{239,77,143,244,230,254,136}}},
		{{{183,19,7,209,190,179,164},{241,126,32,33,220,235,124},{105,10,119,24,225,241,122},{4,181,221,129,63,175,10},{55,187,196,78,44,162,82},{242,158,199,206,204,25,171},{64,32,205,222,26,57,133}}},
		{{{27,110,134,106,250,118,12},{233,101,99,250,190,61,197},{102,227,14,163,85,173,247},{190,206,14,217,171,28,162},{58,237,103,90,174,176,71},{163,6,77,249,109,99,35},{18,147,126,250,197,57,158}}}
	}};
	double mur = 32;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 73", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{241,249,200,88,3,123,226},{119,55,188,70,57,144,117},{129,214,39,140,62,217,115},{19,12,161,76,151,21,207},{193,248,132,53,55,152,71},{80,81,45,63,244,73,0},{87,98,224,145,56,156,226}}},
		{{{105,17,11,213,165,53,139},{174,55,43,183,227,223,183},{199,202,234,56,170,169,48},{82,223,68,166,68,1,223},{128,77,204,46,142,131,71},{57,68,154,63,146,80,130},{195,251,167,192,239,184,192}}},
		{{{195,204,98,86,53,53,239},{248,160,244,241,51,126,199},{233,126,235,56,231,35,87},{56,19,33,71,0,4,224},{189,133,19,49,188,20,204},{138,81,142,122,251,243,182},{59,49,88,92,190,62,136}}},
		{{{98,168,232,246,31,11,173},{97,206,140,61,21,90,214},{122,171,43,24,177,131,33},{162,152,164,54,13,41,32},{199,48,79,48,92,211,175},{171,225,238,131,227,8,227},{155,146,15,5,67,41,67}}},
		{{{194,167,190,118,106,70,196},{148,226,74,101,10,53,57},{203,78,185,143,50,176,195},{65,248,159,206,119,78,129},{190,183,159,146,85,133,121},{125,154,218,47,32,18,162},{145,175,150,73,229,89,76}}},
		{{{222,224,181,10,38,88,53},{58,165,6,137,6,75,216},{127,140,78,95,29,8,140},{125,143,62,23,10,183,221},{51,218,91,36,54,100,167},{109,118,52,89,146,91,107},{183,219,87,124,37,159,182}}},
		{{{210,82,73,28,184,148,57},{126,139,196,190,72,176,41},{168,244,120,35,122,31,8},{68,184,193,39,223,142,132},{99,227,215,246,42,220,73},{92,188,207,81,153,90,12},{197,239,151,232,7,246,222}}}
	}};
	double mur = 44;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 74", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{142,102,157,53,236,20,183},{86,163,71,77,241,166,165},{215,23,226,11,216,165,19},{154,208,156,236,118,76,12},{205,93,119,157,167,90,244},{130,232,35,222,143,94,195},{154,177,50,146,95,182,165}}},
		{{{138,170,227,162,94,65,16},{253,19,68,17,143,217,206},{140,59,24,92,76,38,92},{166,86,149,172,80,240,59},{100,55,193,175,68,8,170},{218,233,76,243,149,5,100},{16,192,155,63,179,222,248}}},
		{{{236,20,156,187,162,213,236},{80,107,65,177,87,224,208},{196,96,104,112,123,181,214},{247,67,85,225,140,133,220},{226,153,113,238,55,23,18},{199,249,51,214,136,200,31},{38,110,42,236,160,175,208}}},
		{{{50,106,168,190,125,105,228},{119,123,66,240,173,175,141},{33,79,217,56,184,58,219},{46,254,191,42,109,16,129},{6,2,180,140,181,127,163},{18,197,161,98,214,36,97},{138,179,10,165,209,93,126}}},
		{{{157,139,163,30,123,250,228},{108,119,244,82,39,151,5},{218,45,33,74,175,141,178},{105,159,248,204,46,102,115},{209,227,160,225,179,10,185},{93,232,153,215,204,199,29},{131,76,44,3,64,232,148}}},
		{{{201,19,112,7,148,91,35},{34,186,245,225,113,73,70},{247,99,30,144,167,210,75},{33,132,238,65,1,138,154},{22,33,143,160,219,74,209},{95,3,233,52,184,98,39},{19,81,97,35,129,147,250}}},
		{{{177,237,67,221,249,191,28},{253,153,62,184,254,93,162},{9,48,189,144,248,21,25},{33,240,138,196,142,176,189},{98,74,65,97,103,131,62},{89,1,59,2,46,191,70},{237,14,249,107,175,159,162}}}
	}};
	double mur = 16;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 75", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{87,219,89,109,203,23,116},{109,150,110,223,2,55,98},{6,189,59,192,171,197,103},{181,220,34,232,175,63,95},{61,52,19,106,224,172,50},{176,31,211,38,6,163,33},{153,57,196,108,124,102,226}}},
		{{{191,193,169,27,169,27,20},{177,120,171,119,144,185,207},{249,214,42,165,100,147,240},{111,56,220,188,137,57,171},{94,33,87,115,191,191,13},{107,237,46,196,97,163,102},{117,177,164,33,95,227,199}}},
		{{{17,82,218,182,215,44,120},{144,35,161,118,192,7,250},{253,96,114,41,196,31,194},{55,147,145,52,217,21,143},{21,38,20,217,50,34,113},{17,90,206,7,237,105,181},{239,87,58,89,155,0,6}}},
		{{{58,2,193,189,19,249,147},{222,136,29,165,160,45,172},{200,124,64,178,174,130,110},{55,155,14,30,242,5,107},{82,111,202,139,177,254,209},{220,91,175,29,63,182,234},{108,124,75,31,188,0,3}}},
		{{{227,3,102,43,233,41,147},{46,217,96,24,195,186,125},{222,154,169,244,68,55,189},{197,196,237,171,139,160,7},{52,34,247,106,13,100,32},{134,144,22,95,9,129,188},{48,248,136,57,89,198,252}}},
		{{{86,48,201,71,123,146,146},{102,191,75,218,87,41,148},{70,192,41,16,251,168,102},{112,235,250,16,237,253,106},{48,202,111,17,176,173,32},{106,130,103,79,106,32,121},{240,238,133,198,46,141,20}}},
		{{{220,180,216,221,246,100,151},{204,46,59,161,33,233,183},{73,163,94,75,214,187,44},{0,185,212,195,237,73,246},{48,36,151,215,172,136,43},{139,177,36,30,49,55,194},{223,134,114,47,251,210,127}}}
	}};
	double mur = 150;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 76", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{131,22,136,162,59,179,89},{70,18,253,13,5,146,234},{42,108,52,162,49,230,53},{169,6,176,198,88,116,94},{176,21,247,72,207,109,171},{60,173,229,190,74,51,161},{38,196,47,226,16,56,25}}},
		{{{157,190,211,175,252,10,231},{202,135,57,209,101,125,73},{3,193,100,231,220,200,75},{231,150,49,189,160,112,8},{6,132,40,49,142,222,125},{217,182,250,72,215,175,130},{174,81,7,161,161,44,110}}},
		{{{206,138,241,3,104,98,62},{254,99,246,144,202,137,64},{70,220,120,221,26,172,170},{119,211,246,33,37,35,200},{129,207,30,163,69,47,167},{149,252,81,153,167,153,16},{53,203,94,178,228,83,181}}},
		{{{159,165,162,94,239,155,92},{226,210,122,42,186,108,32},{169,29,205,1,184,52,177},{198,242,24,225,79,86,164},{103,152,24,163,57,221,16},{188,170,254,70,129,95,75},{113,129,248,90,248,6,139}}},
		{{{142,170,69,168,125,215,151},{172,70,137,52,113,241,41},{6,186,19,170,244,221,172},{90,178,3,182,80,92,106},{65,184,30,101,244,35,26},{47,41,41,102,3,46,25},{92,118,246,49,155,210,54}}},
		{{{33,147,253,79,15,58,81},{193,211,213,246,51,32,76},{148,187,218,225,131,58,116},{7,222,186,245,70,162,69},{134,253,151,120,127,254,0},{113,148,161,218,221,30,88},{60,181,59,62,190,138,175}}},
		{{{64,59,68,93,147,32,148},{142,72,168,134,67,182,126},{217,243,61,31,27,225,179},{165,170,250,124,40,90,153},{140,212,125,26,148,53,111},{167,86,168,158,5,57,245},{48,86,181,9,165,157,93}}}
	}};
	double mur = 222;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 77", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{199,112,53,78,20,149,41},{124,15,118,246,228,215,156},{103,39,124,73,240,37,100},{77,178,47,31,75,204,71},{238,158,227,65,1,242,100},{223,87,53,133,108,147,57},{160,32,11,142,222,186,158}}},
		{{{73,3,197,42,135,60,158},{67,36,210,228,151,148,59},{187,177,113,108,56,214,35},{131,158,37,6,104,5,108},{157,157,55,72,165,65,241},{251,130,178,31,7,194,117},{140,28,135,113,42,204,39}}},
		{{{229,54,37,227,35,132,42},{203,33,81,33,189,197,99},{56,161,163,135,77,85,191},{134,232,218,140,122,234,142},{39,104,17,245,156,162,186},{169,229,216,141,99,201,222},{140,242,182,67,181,107,193}}},
		{{{36,39,206,167,77,70,79},{134,93,119,216,190,36,247},{78,62,30,144,187,71,77},{230,158,161,120,104,96,165},{76,247,134,32,97,28,205},{116,135,18,111,76,184,171},{58,201,32,209,98,207,226}}},
		{{{249,165,41,225,15,4,179},{30,149,211,213,54,111,150},{185,134,35,175,67,107,176},{65,45,28,14,135,61,153},{217,189,19,250,61,171,243},{97,107,223,176,20,44,209},{251,66,132,166,191,216,211}}},
		{{{13,160,185,173,13,140,111},{26,32,15,58,66,11,167},{106,242,239,232,231,169,71},{233,242,50,109,41,16,235},{75,155,128,176,36,224,178},{180,67,117,252,61,229,143},{174,142,194,153,3,231,5}}},
		{{{217,14,39,113,235,135,244},{134,33,184,124,29,197,222},{175,92,161,120,100,84,80},{158,87,159,190,38,210,74},{250,141,37,70,116,127,95},{144,101,208,245,230,90,170},{57,23,115,158,22,7,252}}}
	}};
	double mur = 177;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 78", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{111,228,156,80,148,184,142},{230,69,17,113,25,205,93},{136,23,176,101,183,140,52},{221,34,32,71,253,97,67},{6,254,251,77,247,41,57},{114,228,84,111,88,41,68},{139,242,76,94,94,112,126}}},
		{{{211,225,29,80,208,31,120},{197,146,83,253,242,112,16},{19,84,204,11,184,68,247},{4,232,34,210,165,104,176},{25,94,173,136,17,132,62},{16,108,194,7,172,45,101},{207,7,169,63,231,130,64}}},
		{{{73,74,105,248,207,71,9},{211,111,128,87,224,8,133},{38,190,132,69,155,53,69},{28,49,144,239,4,39,115},{119,130,40,109,31,155,100},{216,26,137,85,26,251,72},{103,61,217,159,32,160,185}}},
		{{{44,19,219,5,162,107,165},{29,25,8,184,231,40,193},{209,68,209,73,206,43,249},{185,92,31,199,89,74,62},{220,226,106,122,136,40,66},{104,90,156,136,252,20,154},{164,82,217,140,10,101,215}}},
		{{{235,253,16,44,111,131,250},{40,16,101,91,156,116,94},{240,24,119,131,130,54,52},{65,44,15,184,220,171,0},{47,13,158,135,230,29,159},{237,127,230,49,56,75,42},{84,192,77,64,191,63,17}}},
		{{{172,46,71,212,41,97,235},{23,203,71,45,180,35,178},{165,134,52,160,28,93,157},{206,230,144,246,0,56,202},{227,81,60,112,230,176,72},{42,4,95,75,185,130,241},{150,184,211,146,204,121,152}}},
		{{{98,109,249,71,239,80,219},{83,156,234,162,184,189,1},{132,229,203,194,177,41,76},{35,24,25,145,7,8,254},{174,188,152,45,123,120,127},{51,43,90,193,8,192,183},{188,213,43,214,254,17,35}}}
	}};
	double mur = 23;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,118,1};
	assert( check(test+" Test 79", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{210,41,211,56,127,90,203},{201,3,145,194,231,254,93},{50,169,76,62,9,148,229},{204,62,193,219,25,187,14},{48,120,131,113,206,25,35},{62,2,8,34,91,206,211},{19,186,83,37,133,140,48}}},
		{{{131,103,56,89,254,27,34},{140,206,29,236,21,91,29},{131,166,76,154,17,144,181},{106,178,49,172,135,247,249},{157,10,239,28,25,236,48},{166,105,234,190,205,18,63},{76,34,123,243,30,136,91}}},
		{{{6,23,10,101,158,184,109},{152,101,105,172,173,75,254},{10,176,48,179,229,5,112},{42,159,102,174,207,86,98},{166,4,235,231,63,54,242},{87,183,145,68,75,129,132},{218,0,41,23,254,39,95}}},
		{{{1,6,249,141,28,78,116},{102,169,108,25,144,38,71},{12,63,159,187,152,138,211},{183,55,93,89,236,15,235},{191,4,51,184,16,234,163},{100,39,205,136,238,92,76},{121,226,84,100,159,221,2}}},
		{{{171,57,64,60,158,45,116},{127,104,137,44,17,89,230},{56,7,187,75,188,68,227},{33,206,187,114,77,73,129},{15,17,189,19,208,62,104},{14,244,103,121,102,175,226},{24,193,75,179,73,17,81}}},
		{{{97,203,241,161,116,237,22},{159,146,172,132,73,52,8},{206,24,208,23,24,142,176},{144,196,68,73,96,141,127},{182,113,140,133,151,12,199},{56,60,82,50,21,36,58},{202,4,149,71,217,110,211}}},
		{{{235,227,226,217,176,16,11},{16,150,51,79,246,148,208},{88,72,235,68,3,27,124},{89,16,72,188,209,70,133},{13,143,68,34,21,26,148},{209,195,98,250,36,4,128},{107,212,76,233,154,23,154}}}
	}};
	double mur = 16;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 80", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{67,102,250,77,1,87,176},{206,204,42,202,228,29,118},{219,14,115,239,173,89,24},{145,253,155,151,96,54,183},{79,234,65,29,103,44,162},{53,2,145,144,3,113,165},{161,236,119,186,4,238,71}}},
		{{{53,225,59,20,39,195,35},{33,192,189,243,53,167,18},{231,186,154,238,249,216,239},{0,120,76,136,61,75,113},{91,144,28,252,15,191,155},{54,87,71,9,44,81,123},{48,225,63,118,221,119,9}}},
		{{{165,252,183,80,75,250,211},{89,176,230,103,185,35,239},{61,140,150,90,225,33,103},{49,25,148,78,118,136,149},{121,108,26,87,168,146,189},{32,121,107,69,58,33,169},{1,128,163,48,87,215,65}}},
		{{{205,175,106,77,195,134,92},{152,60,31,111,242,115,242},{19,129,9,17,169,159,193},{17,27,170,160,206,231,13},{125,49,12,93,61,21,148},{120,206,104,162,99,232,209},{204,9,104,155,118,114,52}}},
		{{{19,208,203,243,94,9,12},{76,155,204,10,142,40,77},{4,243,135,240,231,135,137},{52,130,38,105,87,216,20},{250,94,72,233,22,221,154},{112,224,146,136,172,151,136},{190,183,215,51,222,235,232}}},
		{{{121,196,90,5,208,188,145},{13,144,99,196,241,181,4},{140,163,26,123,39,248,135},{182,123,95,129,251,173,181},{231,203,250,184,12,251,157},{95,208,61,15,55,214,104},{228,95,26,30,20,140,186}}},
		{{{8,228,169,144,87,58,248},{14,171,212,111,193,9,132},{254,252,91,95,179,162,195},{94,94,53,88,146,79,15},{48,21,251,126,102,200,107},{75,77,109,246,66,107,16},{83,42,106,209,194,28,205}}}
	}};
	double mur = 100;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 81", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{43,198,55,136,27,39,242},{112,145,167,110,211,10,6},{103,9,176,68,24,214,81},{200,99,173,238,244,158,11},{115,252,23,36,205,173,101},{156,197,153,71,64,244,120},{46,180,134,32,2,196,107}}},
		{{{197,13,183,88,64,18,19},{128,39,189,159,251,140,192},{164,10,83,63,19,73,153},{104,109,209,21,132,149,220},{8,134,21,84,245,139,202},{251,140,211,138,85,38,43},{110,145,126,170,121,180,3}}},
		{{{1,45,147,23,184,112,109},{237,31,189,182,197,245,165},{92,175,52,197,201,96,71},{75,123,10,41,218,247,54},{197,152,124,107,95,233,172},{154,15,76,66,52,222,202},{14,140,169,173,251,6,254}}},
		{{{136,28,65,225,193,55,150},{156,149,80,6,211,38,180},{230,42,128,20,3,212,26},{35,94,242,147,31,118,105},{129,147,5,1,243,27,56},{81,44,201,88,203,211,113},{72,205,62,205,60,90,39}}},
		{{{33,83,94,134,116,2,194},{163,165,173,181,246,203,198},{151,103,248,140,248,23,177},{203,136,54,189,30,85,159},{57,61,189,88,199,51,92},{124,57,125,214,20,99,78},{94,77,240,77,52,150,15}}},
		{{{206,1,225,48,29,219,173},{6,86,165,127,140,250,112},{97,67,27,200,88,15,105},{195,79,141,33,80,245,92},{135,96,153,10,197,241,170},{240,230,37,229,67,100,128},{13,142,84,237,229,133,156}}},
		{{{146,29,180,67,212,224,23},{110,70,31,248,12,175,175},{75,187,47,30,226,247,235},{66,246,171,189,88,88,182},{42,75,65,73,152,124,78},{107,47,97,230,39,29,237},{173,7,129,164,157,87,131}}}
	}};
	double mur = 98;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 82", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{0,113,101,100,204,125,151},{67,199,187,8,211,102,241},{115,38,37,176,210,28,146},{54,209,85,134,141,151,87},{15,193,136,43,77,221,46},{95,157,183,247,163,168,116},{49,29,105,121,223,226,27}}},
		{{{206,152,12,61,203,85,26},{243,170,123,162,117,42,209},{52,55,245,163,13,42,252},{7,163,166,69,82,124,197},{207,116,186,94,68,44,42},{229,216,205,197,170,55,245},{53,10,159,19,223,158,79}}},
		{{{181,102,49,14,149,37,251},{234,157,147,129,145,172,99},{211,27,173,28,239,188,148},{3,9,127,162,12,199,42},{171,232,74,208,177,184,13},{209,71,97,90,181,58,65},{50,155,55,33,71,28,163}}},
		{{{58,35,222,147,15,47,100},{26,235,228,209,54,83,177},{220,33,122,212,78,29,134},{195,66,58,196,71,57,144},{218,122,109,58,108,134,17},{229,55,6,18,96,141,226},{64,164,66,141,141,24,35}}},
		{{{24,113,218,101,196,181,229},{100,53,152,254,67,145,90},{1,77,138,80,249,170,214},{185,105,240,59,129,88,159},{101,149,141,212,119,94,0},{1,54,68,64,90,143,108},{253,214,11,160,179,45,2}}},
		{{{68,116,214,217,204,81,161},{237,22,6,44,4,40,173},{211,226,245,45,224,39,9},{95,118,23,181,27,116,238},{106,175,130,132,12,3,188},{149,251,41,149,248,65,96},{133,89,232,245,125,94,70}}},
		{{{58,62,71,0,138,31,90},{96,167,67,227,176,222,148},{209,237,232,39,116,17,71},{173,110,154,133,70,242,249},{67,135,176,251,83,219,18},{182,244,125,8,29,0,251},{83,103,18,7,186,8,197}}}
	}};
	double mur = 12;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 83", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{205,9,151,46,241,120,29},{85,126,99,214,169,96,125},{30,1,234,216,95,218,119},{33,207,230,245,67,110,100},{21,205,97,162,233,97,155},{130,138,57,246,222,58,122},{243,69,204,177,79,158,82}}},
		{{{192,133,183,169,89,185,152},{18,29,57,93,144,235,0},{0,196,70,187,66,211,79},{207,111,189,164,114,223,1},{165,240,3,77,180,220,223},{217,249,125,181,168,122,10},{208,201,97,186,245,22,13}}},
		{{{221,64,134,68,109,94,126},{144,126,1,11,159,54,125},{173,46,52,147,242,139,47},{144,125,140,17,161,76,180},{207,22,15,175,37,193,25},{238,73,5,153,223,194,225},{52,163,224,129,241,100,41}}},
		{{{100,243,12,199,98,254,229},{59,60,179,16,247,204,143},{223,86,137,138,164,158,203},{177,45,73,161,167,16,147},{128,140,78,183,11,2,5},{137,108,67,215,0,6,177},{148,212,32,145,52,68,79}}},
		{{{31,150,210,107,34,152,63},{120,105,160,223,197,88,117},{247,127,76,124,178,195,252},{87,84,12,70,239,150,198},{157,143,5,22,245,31,249},{207,223,163,31,199,73,184},{208,247,27,49,85,198,67}}},
		{{{87,26,209,124,124,57,81},{125,95,131,173,55,236,77},{205,190,103,97,27,113,211},{247,96,209,177,94,1,122},{45,178,45,138,116,167,147},{163,87,97,177,164,247,241},{6,155,48,49,243,131,131}}},
		{{{220,180,74,44,175,23,177},{201,33,97,107,31,51,163},{9,176,190,69,175,15,41},{254,33,187,213,225,11,213},{27,48,50,89,127,51,42},{155,116,188,75,5,125,100},{32,161,225,17,229,165,245}}}
	}};
	double mur = 62;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 84", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{103,107,9,113,99,24,140},{106,110,102,204,153,47,141},{173,229,130,120,217,88,36},{199,236,31,98,120,187,91},{149,43,233,81,43,97,97},{83,16,4,25,47,230,246},{22,56,71,146,15,8,236}}},
		{{{105,178,96,160,193,178,103},{191,146,45,7,139,252,139},{193,32,141,96,3,188,108},{121,108,80,154,59,193,159},{227,13,51,246,234,55,140},{183,84,179,79,172,199,157},{202,162,26,102,200,239,189}}},
		{{{160,102,79,164,51,127,76},{91,154,63,111,147,191,187},{219,119,252,204,4,149,252},{75,223,180,95,114,198,130},{7,97,239,51,49,245,112},{246,120,210,181,136,92,61},{117,224,144,110,57,139,141}}},
		{{{228,232,108,111,224,134,194},{190,133,195,160,153,193,231},{30,51,190,193,135,239,238},{37,178,165,90,116,21,194},{213,37,117,73,170,13,27},{108,194,231,88,203,232,3},{63,189,19,208,167,124,29}}},
		{{{206,198,199,135,233,76,143},{171,228,226,54,60,66,137},{18,251,126,108,143,173,173},{39,176,173,254,246,244,87},{217,53,28,253,47,239,12},{186,140,95,129,35,65,186},{150,73,67,211,248,55,151}}},
		{{{130,146,140,36,70,168,2},{196,42,66,225,88,17,35},{236,214,58,210,215,93,75},{195,120,36,90,115,246,119},{31,217,111,46,201,45,54},{109,141,70,75,46,223,154},{58,88,106,163,105,137,37}}},
		{{{192,15,59,45,39,148,139},{109,190,247,203,163,15,204},{58,23,242,34,19,223,212},{251,133,186,100,176,163,103},{93,210,80,86,205,95,148},{35,113,117,38,61,91,89},{213,43,118,39,23,86,249}}}
	}};
	double mur = 174;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 85", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{223,84,139,76,242,218,187},{55,118,59,90,91,166,196},{244,12,246,211,65,173,187},{200,103,183,46,19,116,31},{124,107,218,145,205,131,189},{15,15,190,177,233,53,108},{131,226,53,97,21,232,175}}},
		{{{47,63,127,194,211,158,204},{31,151,3,95,180,47,156},{92,43,165,68,209,238,176},{237,136,251,157,247,192,211},{9,43,216,219,64,65,205},{188,211,32,96,81,95,9},{143,9,0,191,162,26,215}}},
		{{{79,37,10,142,152,138,1},{137,28,86,76,202,174,23},{45,186,192,13,135,116,96},{68,58,203,171,29,34,248},{209,144,190,230,146,62,45},{192,161,229,170,187,210,31},{160,132,53,212,149,4,172}}},
		{{{8,145,188,141,4,248,134},{45,159,224,149,109,179,254},{249,8,215,34,116,125,54},{201,166,22,61,250,69,148},{144,224,157,200,247,220,106},{6,6,109,154,18,166,164},{223,189,171,242,114,61,136}}},
		{{{238,105,190,250,98,114,74},{43,3,49,99,34,37,32},{104,108,99,90,128,192,74},{37,0,197,49,37,10,44},{92,117,30,124,234,138,32},{142,242,98,137,3,52,194},{251,220,253,176,105,131,215}}},
		{{{112,17,62,87,188,70,17},{129,143,36,151,86,73,151},{109,91,111,155,31,227,101},{172,126,227,215,56,158,198},{229,229,85,68,36,81,219},{34,179,152,164,2,150,57},{67,54,207,21,55,246,178}}},
		{{{124,64,191,118,193,173,36},{1,210,107,238,94,19,92},{236,174,239,194,86,138,34},{72,206,239,83,249,9,128},{118,193,168,1,250,75,60},{46,40,17,168,215,199,219},{238,70,243,202,246,108,100}}}
	}};
	double mur = 27;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {121,253,1};
	assert( check(test+" Test 86", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{135,102,35,104,223,148,95},{188,208,242,211,8,229,219},{68,83,99,48,104,171,239},{171,148,93,49,38,42,190},{34,197,40,158,102,25,156},{113,222,210,95,129,83,243},{5,94,206,201,52,8,119}}},
		{{{123,248,98,141,67,150,199},{108,213,10,229,19,86,90},{16,99,1,244,142,129,90},{4,43,112,63,234,214,75},{173,174,129,178,231,242,130},{35,227,162,173,9,120,151},{22,161,123,247,246,146,178}}},
		{{{107,133,244,167,112,67,125},{2,108,117,213,241,81,231},{14,48,80,48,17,77,217},{232,37,209,156,179,245,2},{169,55,124,85,203,16,89},{210,19,136,129,241,162,192},{134,116,223,44,245,186,66}}},
		{{{30,205,18,205,84,235,83},{240,125,167,114,191,76,183},{182,137,138,17,7,163,52},{97,211,222,33,227,230,192},{57,129,225,54,100,209,108},{24,145,165,152,202,189,179},{193,246,137,118,56,215,207}}},
		{{{26,252,69,186,155,89,203},{207,31,171,231,22,33,164},{104,242,146,191,89,189,130},{119,18,70,127,214,102,126},{136,23,230,16,138,209,36},{161,106,64,110,127,173,204},{67,67,68,222,39,147,78}}},
		{{{41,73,225,77,41,33,120},{33,133,223,206,23,211,201},{52,165,58,220,149,155,153},{154,152,184,158,44,90,238},{51,15,47,107,70,55,125},{204,235,212,75,85,229,211},{166,166,60,41,14,235,200}}},
		{{{114,95,146,47,252,140,101},{54,73,35,221,241,17,11},{155,140,246,135,106,240,237},{113,245,198,178,83,143,236},{31,5,156,114,163,31,190},{185,163,63,4,161,62,25},{233,163,145,237,132,32,63}}}
	}};
	double mur = 238;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 87", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{219,110,5,61,89,40,125},{156,206,177,101,245,39,66},{224,212,11,5,148,74,46},{160,41,67,120,23,8,114},{236,9,157,128,141,238,203},{185,231,0,23,248,102,228},{95,229,167,182,52,217,31}}},
		{{{180,93,136,185,126,179,95},{163,245,118,183,107,100,89},{155,145,221,86,173,151,240},{193,38,15,198,122,246,100},{124,69,141,137,248,99,199},{219,158,193,12,75,18,128},{119,139,243,145,109,223,48}}},
		{{{159,48,37,247,236,228,2},{119,179,107,250,146,21,47},{239,125,132,149,176,95,146},{37,165,12,5,234,152,146},{147,93,12,187,245,199,207},{76,7,198,28,125,153,91},{15,167,183,8,17,161,119}}},
		{{{211,77,197,84,26,6,30},{102,212,248,47,74,108,144},{175,212,133,63,64,100,159},{133,4,82,21,69,52,120},{92,7,20,24,218,68,129},{1,241,129,191,135,193,30},{131,199,216,217,60,8,70}}},
		{{{16,62,62,22,14,68,148},{41,14,150,133,162,156,73},{97,82,208,131,178,74,194},{84,164,201,129,0,155,122},{86,22,74,62,170,47,40},{38,11,121,189,155,49,114},{242,188,186,136,41,7,55}}},
		{{{230,86,28,107,245,54,32},{169,81,137,218,25,0,251},{251,208,214,121,237,197,225},{92,82,2,145,67,43,123},{58,27,178,35,42,143,207},{21,98,148,132,105,143,20},{107,47,79,97,250,61,99}}},
		{{{179,139,56,169,207,61,155},{220,105,37,53,187,107,46},{79,61,213,227,15,82,198},{224,186,136,13,72,106,5},{6,128,157,118,119,202,36},{45,230,144,189,9,204,190},{143,197,122,70,41,153,138}}}
	}};
	double mur = 250;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {135,253,0};
	assert( check(test+" Test 88", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{227,157,246,206,221,64,189},{54,240,81,16,52,156,199},{146,28,51,4,240,193,148},{108,89,44,0,137,48,230},{69,147,193,23,109,91,169},{221,13,149,161,174,99,189},{121,232,180,34,24,57,66}}},
		{{{73,171,43,17,118,67,98},{42,204,245,150,38,129,250},{134,232,164,210,69,235,127},{106,98,68,91,10,56,192},{192,19,182,93,66,163,43},{132,138,204,48,16,78,126},{168,205,124,148,218,147,232}}},
		{{{65,29,113,165,29,130,8},{115,17,109,134,54,224,211},{229,135,218,154,67,94,156},{115,199,138,153,62,192,73},{246,55,162,142,227,109,16},{246,233,4,32,124,214,131},{218,3,201,143,10,228,103}}},
		{{{58,175,67,128,199,239,246},{177,101,192,124,249,207,203},{210,32,240,71,207,152,1},{57,231,176,149,21,133,248},{57,91,242,178,206,188,234},{156,102,239,44,43,126,166},{209,165,51,144,232,192,107}}},
		{{{42,60,188,194,86,74,138},{89,141,18,58,169,5,153},{44,155,124,252,169,110,231},{12,73,46,250,233,76,193},{243,26,24,6,106,222,209},{51,252,119,121,137,102,32},{146,167,149,112,81,220,166}}},
		{{{62,117,7,48,57,71,150},{15,57,62,194,242,239,93},{177,235,128,239,82,179,139},{108,108,57,89,79,174,85},{168,186,65,95,94,180,14},{144,179,137,173,155,210,117},{217,59,89,153,47,10,195}}},
		{{{171,56,153,210,202,131,56},{97,95,7,76,174,128,128},{120,167,181,118,212,86,138},{87,94,213,19,141,251,207},{178,62,154,112,233,245,102},{66,228,88,61,78,60,130},{176,91,183,241,212,39,126}}}
	}};
	double mur = 206;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 89", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{39,203,156,166,109,230,49},{221,44,12,156,78,225,202},{212,131,33,143,23,195,38},{168,4,15,53,40,76,93},{84,175,51,33,184,188,115},{200,27,252,4,145,180,18},{73,43,192,93,150,205,156}}},
		{{{183,53,134,98,231,63,74},{221,113,13,134,117,82,124},{30,192,96,154,61,229,110},{81,193,231,74,205,155,105},{51,62,84,67,234,43,15},{174,217,13,203,194,14,158},{123,45,71,200,140,175,134}}},
		{{{125,162,128,46,68,171,151},{116,135,92,35,164,214,155},{170,99,65,169,58,99,31},{17,244,115,8,20,236,137},{212,24,234,100,126,50,70},{39,43,215,97,209,52,95},{141,17,155,217,127,244,71}}},
		{{{107,47,175,28,23,208,46},{59,45,171,152,213,219,89},{44,166,240,26,36,134,232},{235,205,160,243,177,209,57},{133,101,163,58,230,98,174},{204,239,242,225,189,158,249},{51,130,167,28,206,217,21}}},
		{{{177,166,221,236,5,197,171},{145,165,44,95,48,211,132},{55,57,219,233,11,164,173},{138,81,168,71,30,91,30},{177,6,126,247,193,147,109},{10,223,67,12,183,31,162},{204,15,191,41,1,154,68}}},
		{{{6,59,21,156,244,97,78},{247,5,51,211,64,166,251},{220,5,64,130,236,24,170},{34,13,166,36,121,45,240},{155,52,111,40,9,236,136},{129,192,162,186,1,254,138},{209,180,78,1,54,90,37}}},
		{{{135,233,166,32,85,226,9},{189,131,100,96,68,119,160},{92,35,147,241,99,170,121},{157,51,33,236,136,59,252},{108,181,99,210,209,56,169},{245,96,35,112,201,100,44},{124,78,159,59,146,208,168}}}
	}};
	double mur = 227;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 90", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{125,197,99,246,97,197,181},{118,161,240,1,99,242,251},{209,38,151,232,243,36,146},{59,183,218,228,215,204,68},{187,109,239,111,153,88,14},{145,194,180,230,21,190,57},{185,198,162,155,35,223,120}}},
		{{{156,151,174,75,135,230,138},{42,224,30,177,89,117,199},{188,33,93,80,118,242,237},{20,100,185,170,131,220,68},{141,106,236,195,23,80,115},{119,49,135,224,53,55,32},{80,170,151,16,39,226,56}}},
		{{{150,157,213,96,176,253,22},{206,165,113,176,68,53,126},{213,223,80,40,22,151,107},{90,211,154,12,41,8,30},{187,176,126,140,106,133,168},{140,23,75,242,49,65,161},{87,190,39,41,147,225,57}}},
		{{{176,115,35,73,17,213,72},{177,128,14,124,249,254,19},{132,146,185,87,118,205,174},{238,138,211,154,103,247,121},{81,97,222,118,4,115,47},{221,95,153,125,142,180,154},{252,75,118,149,224,198,17}}},
		{{{17,157,74,186,182,140,57},{95,218,118,252,68,57,119},{151,246,247,231,176,196,130},{59,81,122,64,126,176,251},{100,43,229,185,206,56,4},{24,118,117,140,129,116,226},{63,179,238,124,106,151,211}}},
		{{{187,81,95,188,213,226,184},{182,89,115,250,13,17,85},{233,184,182,133,42,13,206},{238,237,41,29,205,50,17},{62,35,244,37,22,254,104},{99,125,174,187,106,19,126},{139,133,22,102,137,124,221}}},
		{{{210,110,217,158,167,11,84},{23,197,2,29,71,164,8},{221,65,233,120,101,222,173},{52,79,241,238,254,8,85},{158,56,236,177,71,218,213},{109,100,152,208,220,23,222},{8,223,101,153,182,14,63}}}
	}};
	double mur = 251;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 91", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{217,237,187,206,136,224,91},{79,15,115,126,188,79,98},{18,56,107,157,28,130,250},{178,252,120,124,254,105,57},{42,10,217,240,145,120,71},{225,88,36,254,29,230,87},{20,42,163,76,93,192,166}}},
		{{{228,130,94,86,26,79,43},{162,143,24,179,162,89,88},{116,96,178,199,223,156,89},{17,39,219,247,114,229,92},{223,20,121,109,36,94,21},{50,18,43,133,131,96,54},{226,70,144,70,163,27,230}}},
		{{{165,36,183,232,222,76,37},{73,140,142,94,227,204,33},{156,6,21,247,154,193,73},{93,94,33,237,150,139,77},{61,226,179,123,173,238,163},{154,19,24,249,76,213,95},{80,173,151,206,39,205,254}}},
		{{{70,12,243,58,133,59,162},{3,19,236,57,235,95,241},{86,85,243,178,126,29,17},{41,228,163,89,187,178,152},{237,232,22,249,191,185,180},{50,246,51,224,87,7,211},{93,161,160,25,94,11,196}}},
		{{{249,202,244,138,190,145,150},{157,204,21,190,36,58,226},{68,202,187,132,36,19,180},{215,43,211,86,138,143,197},{192,13,10,78,173,211,249},{97,183,241,146,201,252,56},{43,64,194,124,158,226,62}}},
		{{{23,73,253,90,97,62,128},{94,165,192,53,178,215,94},{117,129,96,198,26,205,212},{63,213,16,160,211,241,77},{88,69,21,2,248,73,13},{166,43,174,168,161,18,197},{84,194,160,127,241,129,199}}},
		{{{111,184,107,229,222,188,21},{213,72,221,145,223,196,112},{75,31,205,154,151,228,248},{60,7,47,239,24,81,108},{100,240,86,121,90,12,100},{56,191,93,83,102,43,53},{166,33,97,14,92,229,163}}}
	}};
	double mur = 239;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 92", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{38,252,136,144,244,32,204},{73,223,141,30,244,217,7},{127,238,127,85,229,19,113},{30,225,204,217,183,15,195},{11,224,247,131,233,184,240},{252,226,216,104,14,196,162},{17,191,77,21,204,22,14}}},
		{{{218,252,151,146,203,27,200},{8,19,75,88,124,188,205},{251,8,217,100,124,33,20},{81,118,75,188,116,208,225},{4,231,92,220,189,68,52},{37,137,169,179,148,58,157},{94,136,220,171,191,101,184}}},
		{{{31,151,205,155,238,42,6},{40,29,215,236,204,24,194},{85,157,172,91,128,32,252},{84,92,228,113,129,136,211},{249,149,134,71,127,90,132},{96,176,60,70,123,229,200},{169,197,77,190,67,203,110}}},
		{{{207,228,94,44,214,48,210},{154,0,61,121,100,224,68},{93,70,239,31,201,184,39},{21,158,216,173,206,90,210},{208,4,165,104,41,224,62},{8,240,154,168,65,173,22},{136,6,30,69,212,73,210}}},
		{{{225,75,246,125,5,29,99},{160,7,58,152,145,186,73},{86,109,71,160,6,82,198},{176,189,66,133,203,162,68},{146,177,213,151,121,221,82},{77,9,171,13,134,243,64},{15,22,151,106,44,125,193}}},
		{{{128,74,12,251,142,114,235},{212,102,96,64,42,135,90},{2,35,129,106,247,64,73},{183,216,254,123,76,217,120},{176,241,148,37,169,40,105},{215,76,162,37,80,67,188},{185,244,154,159,176,107,110}}},
		{{{196,33,178,229,159,101,205},{153,82,168,18,91,86,101},{145,183,153,95,86,165,209},{125,203,67,233,119,218,120},{164,190,178,15,202,232,166},{115,160,152,34,7,173,1},{239,96,135,121,22,126,52}}}
	}};
	double mur = 157;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 93", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{244,99,99,207,162,99,192},{244,15,62,99,98,204,6},{118,190,22,186,133,223,96},{1,165,47,17,70,111,196},{38,190,87,139,254,152,174},{241,229,136,77,157,215,228},{42,49,235,74,233,253,144}}},
		{{{165,97,204,97,159,8,17},{220,34,70,147,241,88,222},{173,84,21,88,24,100,187},{32,122,235,82,228,28,113},{41,165,94,105,203,41,19},{108,248,91,204,177,7,41},{94,216,201,22,32,110,202}}},
		{{{127,78,127,141,62,132,182},{2,220,244,101,96,64,187},{100,29,251,155,192,181,86},{181,206,216,146,225,116,157},{217,72,99,66,56,193,14},{248,15,27,237,70,70,27},{168,200,210,193,28,253,4}}},
		{{{78,139,229,168,134,207,115},{133,5,158,137,70,36,176},{137,123,168,51,167,253,235},{239,186,221,185,7,193,76},{176,112,31,31,176,55,176},{232,46,25,93,120,80,69},{27,88,10,185,212,35,136}}},
		{{{219,13,37,132,26,124,203},{136,81,84,5,148,165,125},{48,147,108,108,209,34,234},{82,39,13,196,150,104,59},{42,7,168,61,148,55,136},{154,8,174,139,219,54,119},{130,58,12,248,212,119,106}}},
		{{{127,115,66,237,195,76,104},{251,107,43,160,208,113,5},{247,91,189,19,50,20,85},{197,142,244,120,67,179,44},{177,60,185,171,228,97,222},{160,238,41,150,103,92,9},{57,181,87,161,158,167,225}}},
		{{{97,86,64,184,35,235,39},{133,186,59,217,191,235,75},{163,21,168,241,205,33,199},{143,161,144,16,196,6,52},{206,61,35,130,7,185,25},{89,126,188,220,114,88,227},{224,108,68,223,132,113,105}}}
	}};
	double mur = 10;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 94", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{60,193,82,68,237,175,48},{78,13,53,11,64,7,239},{135,216,207,146,144,118,248},{215,208,252,104,12,74,32},{191,217,141,9,190,126,73},{86,36,139,39,151,61,70},{56,102,226,233,149,39,111}}},
		{{{198,226,46,60,245,218,106},{141,244,208,112,218,69,87},{175,15,252,18,126,28,150},{214,250,224,75,210,1,206},{7,136,177,207,87,87,127},{75,108,46,3,107,244,75},{221,59,152,5,112,162,110}}},
		{{{238,236,124,219,8,48,111},{105,127,204,245,209,236,167},{69,65,145,116,139,158,161},{22,195,242,125,102,210,4},{46,91,192,95,106,57,79},{50,169,36,64,249,35,104},{240,92,86,237,17,220,59}}},
		{{{24,33,169,251,138,132,229},{239,156,36,206,214,43,229},{14,150,113,201,128,186,113},{9,16,19,97,122,254,119},{245,86,25,202,137,200,96},{35,171,209,40,25,52,207},{155,135,20,241,105,244,103}}},
		{{{177,60,62,107,251,99,115},{187,3,136,165,11,77,143},{235,5,48,99,122,251,223},{161,57,229,231,35,230,126},{164,108,68,2,237,13,32},{170,245,141,13,222,26,7},{189,44,84,142,113,147,172}}},
		{{{223,194,40,253,90,242,219},{105,170,57,138,111,61,45},{171,93,110,91,15,113,11},{144,119,31,119,161,218,236},{57,207,77,198,33,148,13},{200,245,169,181,22,165,43},{38,123,122,245,149,55,247}}},
		{{{162,230,36,38,187,99,68},{150,68,53,6,185,115,251},{57,138,121,45,246,154,212},{59,42,139,44,86,159,43},{238,178,202,160,20,217,222},{63,226,16,86,94,10,105},{214,22,138,139,114,183,138}}}
	}};
	double mur = 221;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {129,253,0};
	assert( check(test+" Test 95", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{162,166,111,34,120,207,97},{114,101,38,177,65,16,218},{51,200,160,117,112,90,77},{211,100,242,238,199,203,31},{186,103,20,181,142,73,104},{253,194,163,89,116,102,229},{117,13,155,213,175,148,229}}},
		{{{183,144,73,230,169,20,12},{100,64,244,171,231,168,70},{91,105,24,102,17,144,114},{5,193,70,27,114,199,210},{22,146,251,126,212,216,206},{52,222,125,116,145,252,82},{221,191,44,199,47,39,171}}},
		{{{164,253,172,48,176,124,11},{232,143,174,146,26,176,192},{186,20,52,2,13,21,164},{71,38,67,86,199,198,245},{84,60,13,230,204,26,227},{191,9,117,61,169,245,43},{119,90,45,73,112,239,146}}},
		{{{49,7,146,86,150,179,56},{149,132,24,29,233,33,3},{182,146,144,106,249,9,244},{218,207,8,126,197,18,45},{251,126,144,239,21,93,220},{136,65,180,243,208,225,138},{123,71,193,90,52,207,141}}},
		{{{222,40,198,192,145,128,241},{171,74,85,207,159,225,169},{204,1,206,159,212,206,113},{53,188,36,152,30,204,38},{113,168,159,93,192,49,76},{99,137,121,127,230,113,153},{87,167,5,19,94,165,184}}},
		{{{9,71,36,199,6,211,38},{240,184,48,17,230,65,226},{32,43,101,140,91,63,146},{150,108,90,119,134,57,161},{127,125,128,25,79,167,157},{112,137,92,173,130,32,153},{142,54,10,136,189,188,197}}},
		{{{130,40,19,167,248,16,136},{45,163,102,133,142,95,176},{112,108,147,174,152,211,67},{11,3,153,148,87,96,211},{224,154,195,109,82,226,132},{39,214,132,75,29,47,166},{233,118,50,122,238,193,141}}}
	}};
	double mur = 140;
	int V = 4;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 96", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{40,187,156,107,211,173,113},{187,152,67,24,94,102,24},{141,207,221,25,157,14,9},{77,128,2,63,150,152,57},{124,165,48,226,79,109,65},{153,92,92,99,100,102,211},{101,103,219,151,48,4,251}}},
		{{{212,22,216,51,66,74,119},{149,107,107,187,42,246,77},{100,82,73,90,164,112,147},{184,49,72,151,214,250,182},{201,228,137,51,59,168,82},{120,5,95,137,57,31,53},{48,169,250,72,166,11,47}}},
		{{{213,141,181,87,42,217,189},{69,15,65,247,63,151,220},{16,27,182,128,25,89,3},{43,21,121,225,88,230,45},{131,212,40,82,74,94,7},{123,5,147,85,176,39,239},{162,175,52,34,164,93,195}}},
		{{{207,157,0,223,87,220,115},{240,195,195,147,146,17,210},{70,4,32,204,42,182,24},{10,218,101,127,245,15,39},{16,67,69,121,111,185,73},{8,220,73,88,150,119,140},{137,121,112,161,173,223,113}}},
		{{{252,236,145,113,144,208,126},{195,206,78,0,181,219,43},{50,193,73,130,231,142,126},{72,171,248,153,48,48,182},{199,44,42,9,127,0,85},{8,246,64,118,128,151,207},{57,143,186,139,182,123,110}}},
		{{{37,0,241,36,32,74,222},{68,144,220,128,134,60,158},{240,57,234,232,92,151,29},{14,86,93,163,112,154,70},{113,124,119,242,80,6,97},{28,86,201,211,34,230,89},{109,243,253,5,100,170,37}}},
		{{{30,202,106,42,202,30,192},{83,144,196,55,65,47,209},{89,90,92,75,161,236,195},{250,195,142,155,30,134,42},{77,36,68,193,250,119,65},{226,173,176,13,64,5,74},{6,11,109,87,253,29,246}}}
	}};
	double mur = 64;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 97", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{231,172,93,139,121,115,229},{209,228,17,33,151,37,93},{118,163,66,204,96,23,254},{46,207,175,205,239,248,186},{15,182,52,85,232,168,191},{207,120,22,165,241,23,54},{203,63,77,75,228,211,10}}},
		{{{94,190,250,193,177,174,200},{121,250,112,246,91,70,19},{187,9,25,152,137,71,155},{55,134,47,223,138,153,37},{32,131,105,253,3,137,243},{99,63,234,43,46,16,61},{84,204,119,8,149,102,209}}},
		{{{177,229,99,103,27,160,98},{0,126,17,28,171,216,169},{247,9,67,44,95,145,143},{149,78,201,177,201,201,97},{111,200,169,18,164,181,109},{33,187,190,241,220,34,246},{140,155,131,129,51,139,220}}},
		{{{82,92,149,222,139,137,140},{121,183,1,40,118,217,75},{53,54,126,53,106,144,39},{156,99,182,144,193,71,194},{20,248,230,91,222,154,37},{70,174,190,167,107,167,188},{204,112,152,220,251,96,113}}},
		{{{19,191,204,34,105,186,113},{67,42,175,129,204,91,191},{74,216,242,57,8,147,50},{183,164,13,230,173,224,77},{210,98,62,224,239,37,86},{110,0,45,85,114,247,37},{48,125,233,69,75,236,171}}},
		{{{88,198,99,1,135,212,154},{60,226,9,110,60,48,193},{246,24,205,119,169,47,169},{10,120,127,119,107,252,65},{193,172,6,144,86,12,120},{36,39,27,21,28,211,2},{234,119,189,189,219,64,235}}},
		{{{48,110,200,221,160,165,143},{202,88,147,22,109,101,35},{219,67,249,77,23,138,187},{237,207,243,166,74,32,186},{244,13,156,35,88,206,3},{35,113,26,36,53,51,237},{222,86,76,251,253,67,195}}}
	}};
	double mur = 197;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,0};
	assert( check(test+" Test 98", LBPcode, truth) );
}
{
	Array3D<int,7,7,7> array = {{
		{{{172,99,190,150,81,146,187},{99,28,155,86,192,39,6},{170,220,64,83,162,17,82},{90,193,165,191,64,53,182},{117,251,109,119,205,156,57},{64,195,78,61,99,131,131},{219,86,120,232,8,176,61}}},
		{{{29,121,97,88,13,127,165},{124,43,209,235,167,138,58},{133,83,151,87,22,69,3},{250,129,156,221,184,14,130},{182,150,251,120,237,187,47},{236,245,64,92,245,233,253},{174,16,161,250,46,70,79}}},
		{{{174,236,106,53,85,245,87},{1,181,131,60,180,46,182},{173,215,128,81,245,103,47},{2,187,108,187,85,232,60},{119,2,199,80,183,10,212},{207,165,104,33,67,109,9},{32,2,176,2,62,91,73}}},
		{{{176,245,28,42,208,145,13},{70,29,42,69,82,243,217},{117,146,6,6,154,229,164},{132,194,78,223,78,112,43},{171,197,51,66,61,232,235},{247,32,242,174,168,214,42},{246,72,103,161,202,22,156}}},
		{{{139,186,111,22,219,102,94},{174,44,179,223,143,13,171},{243,222,76,31,148,176,127},{34,204,113,159,34,214,170},{99,149,41,28,30,171,22},{231,147,198,44,147,121,3},{7,167,1,241,122,191,236}}},
		{{{59,28,32,117,98,121,139},{27,247,61,11,229,56,205},{250,190,240,29,181,237,17},{57,220,193,50,40,131,246},{239,2,161,37,36,124,27},{253,237,114,192,227,197,200},{134,140,164,253,129,110,247}}},
		{{{229,190,33,132,41,173,152},{191,159,129,226,43,83,0},{98,60,135,177,226,2,120},{217,73,32,39,132,233,165},{166,22,27,141,48,66,168},{157,240,253,27,145,190,131},{157,48,66,131,97,67,7}}}
	}};
	double mur = 38;
	int V = 3;
	NI_RD_CI_LBP<P252g,R3> lbp(mur, V);
	Array1D<int,3> LBPcode = lbp.convert(array);
	Array1D<int,3> truth = {253,253,1};
	assert( check(test+" Test 99", LBPcode, truth) );
}
}
